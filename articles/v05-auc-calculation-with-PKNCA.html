<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PKNCA">
<title>AUC Calculation with PKNCA â€¢ PKNCA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="AUC Calculation with PKNCA">
<meta property="og:description" content="PKNCA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PKNCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v01-introduction-and-usage.html">Introduction to PKNCA and Usage Instructions</a>
    <a class="dropdown-item" href="../articles/v02-example-theophylline.html">Computing NCA Parameters for Theophylline</a>
    <a class="dropdown-item" href="../articles/v03-selection-of-calculation-intervals.html">Selection of Calculation Intervals</a>
    <a class="dropdown-item" href="../articles/v04-sparse.html">Sparse NCA Calculations</a>
    <a class="dropdown-item" href="../articles/v05-auc-calculation-with-PKNCA.html">AUC Calculation with PKNCA</a>
    <a class="dropdown-item" href="../articles/v06-half-life-calculation-tobit.html">Half-Life Calculation with Tobit Regression</a>
    <a class="dropdown-item" href="../articles/v06-half-life-calculation.html">Half-Life Calculation</a>
    <a class="dropdown-item" href="../articles/v07-post-processing.html">Post-Processing</a>
    <a class="dropdown-item" href="../articles/v07-unit-conversion.html">Unit Assignment and Conversion with PKNCA</a>
    <a class="dropdown-item" href="../articles/v08-data-imputation.html">Data Imputation</a>
    <a class="dropdown-item" href="../articles/v20-superposition.html">Superposition of Pharmacokinetic Data</a>
    <a class="dropdown-item" href="../articles/v21-methods-for-dose-aware-interpolation-and-extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a>
    <a class="dropdown-item" href="../articles/v22-time-to-steady-state.html">Noncompartmental evaluation of time to steady-state</a>
    <a class="dropdown-item" href="../articles/v23-auc-integration-methods.html">AUC integration methods</a>
    <a class="dropdown-item" href="../articles/v30-training-session.html">PKNCA Training Sessions</a>
    <a class="dropdown-item" href="../articles/v40-options-for-controlling-PKNCA.html">Options for Controlling PKNCA</a>
    <a class="dropdown-item" href="../articles/v60-PKNCA-validation.html">PKNCA Validation</a>
    <a class="dropdown-item" href="../articles/v80-writing-parameter-functions.html">Writing PKNCA Parameter Functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/billdenney/pknca/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>AUC Calculation with PKNCA</h1>
                        <h4 data-toc-skip class="author">Bill
Denney</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/billdenney/pknca/blob/HEAD/vignettes/v05-auc-calculation-with-PKNCA.Rmd" class="external-link"><code>vignettes/v05-auc-calculation-with-PKNCA.Rmd</code></a></small>
      <div class="d-none name"><code>v05-auc-calculation-with-PKNCA.Rmd</code></div>
    </div>

    
    
<p>Area Under the Curve (AUC) is a commonly-used metric for assessing
exposure to a drug. Many variants of AUC exist, and the information
below will assist in determining both the appropriate AUC and how to
calculate it.</p>
<div class="section level2">
<h2 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h2>
<p>For the below examples, the following data will be used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/" class="external-link">PKNCA</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">scale_colour_discrete</span> <span class="op">&lt;-</span> <span class="va">scale_colour_hue</span></span>
<span><span class="va">scale_fill_discrete</span> <span class="op">&lt;-</span> <span class="va">scale_fill_hue</span></span>
<span></span>
<span><span class="va">my_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>conc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1.5</span>, <span class="fl">1.2</span>, <span class="fl">1.1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                      time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">24</span><span class="op">)</span>,</span>
<span>                      subject<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span> <span class="op">&lt;-</span> <span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span> <span class="op">==</span> <span class="fl">0</span></span>
<span><span class="va">my_conc</span><span class="op">$</span><span class="va">measured</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my_conc</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>,</span>
<span>           y<span class="op">=</span><span class="va">conc</span>,</span>
<span>           shape<span class="op">=</span><span class="va">BLQ</span>,</span>
<span>           group<span class="op">=</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2</span></span>
<span><span class="co">## 3.5.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">â„¹</span> Please use the `legend.position.inside` argument of `theme()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="v05-auc-calculation-with-PKNCA_files/figure-html/setup-visualization-1.png" width="700"></p>
<p>For the purpose of illustration, NCA parameters will also be
calculated for each of the AUC types below. Note that in the results,
more parameters are returned than were requested. The additional
parameters are the set of parameters required to calculate the requested
parameters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">my_conc</span>, <span class="va">conc</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span></span>
<span><span class="va">data_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span>data.conc<span class="op">=</span><span class="va">conc_obj</span>,</span>
<span>                      intervals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>,</span>
<span>                                           end<span class="op">=</span><span class="fl">24</span>,</span>
<span>                                           aucall<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                           auclast<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                           aucinf.pred<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                           aucinf.obs<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">data_obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No dose information provided, calculations requiring dose will return NA.</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">subject</th>
<th align="right">start</th>
<th align="right">end</th>
<th align="left">PPTESTCD</th>
<th align="right">PPORRES</th>
<th align="left">exclude</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">auclast</td>
<td align="right">12.9965842</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">aucall</td>
<td align="right">15.1965842</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">tmax</td>
<td align="right">2.0000000</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">tlast</td>
<td align="right">8.0000000</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">clast.obs</td>
<td align="right">1.1000000</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">lambda.z</td>
<td align="right">0.1075592</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">r.squared</td>
<td align="right">0.7580245</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">adj.r.squared</td>
<td align="right">0.6370368</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">lambda.z.time.first</td>
<td align="right">3.0000000</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">lambda.z.n.points</td>
<td align="right">4.0000000</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">clast.pred</td>
<td align="right">1.0216136</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">half.life</td>
<td align="right">6.4443313</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">span.ratio</td>
<td align="right">0.7758757</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">aucinf.obs</td>
<td align="right">23.2235095</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">24</td>
<td align="left">aucinf.pred</td>
<td align="right">22.4947355</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="auc-to-the-last-value-above-the-limit-of-quantification-auclast">AUC to the Last Value Above the Limit of Quantification
(AUC<sub>last</sub>)<a class="anchor" aria-label="anchor" href="#auc-to-the-last-value-above-the-limit-of-quantification-auclast"></a>
</h2>
<p>AUC<sub>0-last</sub> calculates the AUC from time 0 to the last value
above the limit of quantification, <code>tlast</code> (within PKNCA,
this is the last value above 0). In the figure below,
AUC<sub>0-last</sub> integrate the shaded region. Integration after
<code>tlast</code> is 0.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tlast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.calc.tlast.html">pk.calc.tlast</a></span><span class="op">(</span>conc<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>                       time<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">tlast</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 8</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_conc</span><span class="op">$</span><span class="va">include_auclast</span> <span class="op">&lt;-</span> <span class="va">my_conc</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">tlast</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my_conc</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>,</span>
<span>           y<span class="op">=</span><span class="va">conc</span>,</span>
<span>           shape<span class="op">=</span><span class="va">BLQ</span>,</span>
<span>           group<span class="op">=</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">my_conc</span><span class="op">[</span><span class="va">my_conc</span><span class="op">$</span><span class="va">include_auclast</span>,<span class="op">]</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="fl">0</span>, ymax<span class="op">=</span><span class="va">conc</span><span class="op">)</span>,</span>
<span>              fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="v05-auc-calculation-with-PKNCA_files/figure-html/auclast-visualization-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="aucall">AUC<sub>all</sub><a class="anchor" aria-label="anchor" href="#aucall"></a>
</h2>
<p>AUC<sub>all</sub> starts with AUC<sub>0-last</sub> and then
integrates from <code>tlast</code> to the first point after
<code>tlast</code> with a linear interpolation to zero. From the second
point after <code>tlast</code> to <span class="math inline">\(\infty\)</span> is considered zero.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_after_tlast</span> <span class="op">&lt;-</span> <span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span> <span class="op">&gt;</span> <span class="va">tlast</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">first_after_tlast</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 12</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_conc</span><span class="op">$</span><span class="va">include_aucall</span> <span class="op">&lt;-</span> <span class="va">my_conc</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;=</span> <span class="va">first_after_tlast</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my_conc</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>,</span>
<span>           y<span class="op">=</span><span class="va">conc</span>,</span>
<span>           shape<span class="op">=</span><span class="va">BLQ</span>,</span>
<span>           group<span class="op">=</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">my_conc</span><span class="op">[</span><span class="va">my_conc</span><span class="op">$</span><span class="va">include_aucall</span>,<span class="op">]</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="fl">0</span>, ymax<span class="op">=</span><span class="va">conc</span><span class="op">)</span>,</span>
<span>              fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="v05-auc-calculation-with-PKNCA_files/figure-html/aucall-visualization-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="auc-to-infinity-aucinfty">AUC to Infinity (AUC<sub><span class="math inline">\(\infty\)</span></sub>)<a class="anchor" aria-label="anchor" href="#auc-to-infinity-aucinfty"></a>
</h2>
<p>AUC<sub>0-<span class="math inline">\(\infty\)</span></sub> is
commonly used for single-dose data. It calculates the
AUC<sub>0-last</sub> and then extrapolates to <span class="math inline">\(\infty\)</span> using the estimated half-life. Two
starting points are used to estimate from <code>tlast</code> to <span class="math inline">\(\infty\)</span>, the observed or half-life
predicted concentration at <code>tlast</code> (<code>clast.obs</code>
and <code>clast.pred</code>).</p>
<p>The two figures below illustrate the integration with AUC<sub>0-<span class="math inline">\(\infty\)</span>,obs</sub> and AUC~0-<span class="math inline">\(\infty\)</span>,pred$. The difference between the
tow figures is most evident at time=8 where there is a discontinuity in
integration at <code>tlast</code> due to using <code>clast.pred</code>
after that point and <code>clast.obs</code> before that point. (To
illustrate the integration differences, BLQ indicator shapes have been
removed. BLQ is handled identically to previous figures.)</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add one row to illustrate extrapolation beyond observed data</span></span>
<span><span class="va">my_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">my_conc</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>conc<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                   time<span class="op">=</span><span class="fl">36</span>,</span>
<span>                   subject<span class="op">=</span><span class="fl">1</span>,</span>
<span>                   BLQ<span class="op">=</span><span class="cn">NA</span>,</span>
<span>                   measured<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                   include_auclast<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                   include_aucall<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Extrapolate concentrations for aucinf.obs</span></span>
<span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc_aucinf.obs</span> <span class="op">&lt;-</span> <span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span></span>
<span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc_aucinf.obs</span><span class="op">[</span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/interp.extrap.conc.html">interp.extrap.conc</a></span><span class="op">(</span>conc<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>                     time<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span>,</span>
<span>                     time.out<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                     lambda.z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">$</span><span class="va">PPORRES</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">$</span><span class="va">PPTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"lambda.z"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extrapolate concentrations for aucinf.pred</span></span>
<span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc_aucinf.pred</span> <span class="op">&lt;-</span> <span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span></span>
<span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc_aucinf.pred</span><span class="op">[</span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/interp.extrap.conc.html">interp.extrap.conc</a></span><span class="op">(</span>conc<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>                     time<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span>,</span>
<span>                     time.out<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">my_conc</span><span class="op">$</span><span class="va">BLQ</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                     lambda.z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">$</span><span class="va">PPORRES</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">$</span><span class="va">PPTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"lambda.z"</span><span class="op">]</span>,</span>
<span>                     clast<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">$</span><span class="va">PPORRES</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">$</span><span class="va">PPTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"clast.pred"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc_aucinf.pred</span><span class="op">[</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="va">tlast</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">$</span><span class="va">PPORRES</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span><span class="op">$</span><span class="va">PPTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"clast.pred"</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my_conc</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span><span class="op">)</span>,<span class="op">]</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>,</span>
<span>           y<span class="op">=</span><span class="va">conc</span>,</span>
<span>           <span class="co">#shape=BLQ,</span></span>
<span>           group<span class="op">=</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">my_conc</span>,</span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="fl">0</span>, ymax<span class="op">=</span><span class="va">conc_aucinf.obs</span><span class="op">)</span>,</span>
<span>              fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_point(size=2) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Extrapolation using AUCinf,obs"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v05-auc-calculation-with-PKNCA_files/figure-html/aucinf-visualization-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my_conc</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span><span class="op">)</span>,<span class="op">]</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>,</span>
<span>           y<span class="op">=</span><span class="va">conc</span>,</span>
<span>           <span class="co">#shape=BLQ,</span></span>
<span>           group<span class="op">=</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span></span>
<span>    data<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">my_conc</span>,</span>
<span>                       before<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">my_conc</span>, <span class="va">time</span> <span class="op">==</span> <span class="va">tlast</span><span class="op">)</span>,</span>
<span>                       conc_aucinf.pred<span class="op">=</span><span class="va">conc</span>,</span>
<span>                       before<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">time</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">before</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="fl">0</span>,</span>
<span>        ymax<span class="op">=</span><span class="va">conc_aucinf.pred</span><span class="op">)</span>,</span>
<span>    fill<span class="op">=</span><span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_point(size=2) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Extrapolation using AUCinf,pred"</span><span class="op">)</span></span></code></pre></div>
<p><img src="v05-auc-calculation-with-PKNCA_files/figure-html/aucinf-visualization-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="partial-aucs">Partial AUCs<a class="anchor" aria-label="anchor" href="#partial-aucs"></a>
</h2>
<p>Partial AUCs integrate part of the area within a time range of
interest. Partial AUCs are often of interest to assess bioequivalence
with more detail than AUC<sub>0-<span class="math inline">\(\infty\)</span></sub> or AUC<sub>0-last</sub> may
indicate. Within PKNCA, partial AUCs are treated like AUC<sub>last</sub>
with start and end times separately selected. (In a future version of
PKNCA, they will be more simply calculated using an
AUC<sub>interval</sub>.)</p>
<p>When the starting and ending times are observed within the data,
partial AUCs can be calculated using the parameter <code>auclast</code>
as illustrated below.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Interpolation not required</span></span>
<span><span class="va">data_obs_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">conc_obj</span>, intervals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fl">2</span>, auclast<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results_obs_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">data_obs_obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No dose information provided, calculations requiring dose will return NA.</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_obs_obj</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">subject</th>
<th align="right">start</th>
<th align="right">end</th>
<th align="left">PPTESTCD</th>
<th align="right">PPORRES</th>
<th align="left">exclude</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="left">auclast</td>
<td align="right">4</td>
<td align="left">NA</td>
</tr></tbody>
</table>
<p>When the starting and ending times are not observed within the data
or when samples are below the limit of quantification, concentrations
must be interpolated and added to the dataset before calculation as
illustrated below.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Interpolation required</span></span>
<span><span class="va">my_conc_interp</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>      <span class="va">my_conc</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>conc<span class="op">=</span><span class="fu"><a href="../reference/interp.extrap.conc.html">interp.extrap.conc</a></span><span class="op">(</span>conc<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">conc</span>, time<span class="op">=</span><span class="va">my_conc</span><span class="op">$</span><span class="va">time</span>, time.out<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                 time<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>                 subject<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">time</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">my_conc_interp</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="5%">
<col width="5%">
<col width="8%">
<col width="6%">
<col width="9%">
<col width="16%">
<col width="15%">
<col width="16%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="right">conc</th>
<th align="right">time</th>
<th align="right">subject</th>
<th align="left">BLQ</th>
<th align="left">measured</th>
<th align="left">include_auclast</th>
<th align="left">include_aucall</th>
<th align="right">conc_aucinf.obs</th>
<th align="right">conc_aucinf.pred</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.00</td>
<td align="right">0.0</td>
<td align="right">1</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="right">2.50</td>
<td align="right">1.0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">2.5000000</td>
<td align="right">2.5000000</td>
</tr>
<tr class="odd">
<td align="right">2.75</td>
<td align="right">1.5</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">3.00</td>
<td align="right">2.0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">3.0000000</td>
<td align="right">3.0000000</td>
</tr>
<tr class="odd">
<td align="right">2.00</td>
<td align="right">3.0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">2.0000000</td>
<td align="right">2.0000000</td>
</tr>
<tr class="even">
<td align="right">1.50</td>
<td align="right">4.0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">1.5000000</td>
<td align="right">1.5000000</td>
</tr>
<tr class="odd">
<td align="right">1.20</td>
<td align="right">5.0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">1.2000000</td>
<td align="right">1.2000000</td>
</tr>
<tr class="even">
<td align="right">1.10</td>
<td align="right">8.0</td>
<td align="right">1</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="right">1.1000000</td>
<td align="right">1.0216136</td>
</tr>
<tr class="odd">
<td align="right">0.00</td>
<td align="right">12.0</td>
<td align="right">1</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="right">0.7153906</td>
<td align="right">0.6644116</td>
</tr>
<tr class="even">
<td align="right">0.00</td>
<td align="right">24.0</td>
<td align="right">1</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">0.1967862</td>
<td align="right">0.1827632</td>
</tr>
<tr class="odd">
<td align="right">NA</td>
<td align="right">36.0</td>
<td align="right">1</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="right">0.0541310</td>
<td align="right">0.0502736</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conc_interp_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">my_conc_interp</span>, <span class="va">conc</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">subject</span><span class="op">)</span></span>
<span><span class="va">data_interp_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">conc_interp_obj</span>, intervals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fl">1.5</span>, auclast<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results_interp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">data_interp_obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No dose information provided, calculations requiring dose will return NA.</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">results_interp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 Ã— 6</span></span></span>
<span><span class="co">##   subject start   end PPTESTCD PPORRES exclude</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>       1     0   1.5 auclast     2.56 <span style="color: #BB0000;">NA</span></span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
