<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to PKNCA and Usage Instructions • PKNCA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to PKNCA and Usage Instructions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PKNCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01-introduction-and-usage.html">Introduction to PKNCA and Usage Instructions</a></li>
    <li><a class="dropdown-item" href="../articles/v02-example-theophylline.html">Computing NCA Parameters for Theophylline</a></li>
    <li><a class="dropdown-item" href="../articles/v03-selection-of-calculation-intervals.html">Selection of Calculation Intervals</a></li>
    <li><a class="dropdown-item" href="../articles/v04-sparse.html">Sparse NCA Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/v05-auc-calculation-with-PKNCA.html">AUC Calculation with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation-tobit.html">Half-life calculation with Tobit regression</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation.html">Half-Life Calculation</a></li>
    <li><a class="dropdown-item" href="../articles/v07-post-processing.html">Post-Processing</a></li>
    <li><a class="dropdown-item" href="../articles/v07-unit-conversion.html">Unit Assignment and Conversion with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v08-data-imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/v20-superposition.html">Superposition of Pharmacokinetic Data</a></li>
    <li><a class="dropdown-item" href="../articles/v21-methods-for-dose-aware-interpolation-and-extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a></li>
    <li><a class="dropdown-item" href="../articles/v22-time-to-steady-state.html">Noncompartmental evaluation of time to steady-state</a></li>
    <li><a class="dropdown-item" href="../articles/v23-auc-integration-methods.html">AUC integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/v30-training-session.html">PKNCA Training Sessions</a></li>
    <li><a class="dropdown-item" href="../articles/v40-options-for-controlling-PKNCA.html">Options for Controlling PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v60-PKNCA-validation.html">PKNCA Validation</a></li>
    <li><a class="dropdown-item" href="../articles/v80-writing-parameter-functions.html">Writing PKNCA Parameter Functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/billdenney/pknca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to PKNCA and Usage Instructions</h1>
                        <h4 data-toc-skip class="author">Bill
Denney</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/billdenney/pknca/blob/main/vignettes/v01-introduction-and-usage.Rmd" class="external-link"><code>vignettes/v01-introduction-and-usage.Rmd</code></a></small>
      <div class="d-none name"><code>v01-introduction-and-usage.Rmd</code></div>
    </div>

    
    
<p>PKNCA provides functions to complete noncompartmental analysis (NCA)
for pharmacokinetic (PK) data. Its intent is to provide a complete
R-based solution enabling data provenance for NCA including tracking
data cleaning, enabling calculations, exporting results, and reporting.
The library is designed to give a reasonable answer without user
intervention (load, calculate, and summarize), but it allows the user to
override the automatic selections at any point.</p>
<p>The library design is modular to allow expansion based on needs
unforseen by the authors including new NCA parameters, novel data
cleaning methods, and modular summarization decisions. Expanding the
library will be discussed in a separate vignette.</p>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>The simplest analysis requires concentration and dosing data, then
five function calls can provide summarized results. (Please note that
this and the other examples in this document are intended to show the
typical workflow, but they are not intended to run directly. For an
example to run directly, please see <a href="v02-example-theophylline.html">the theophylline example</a>.)</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/" class="external-link">PKNCA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load the PK concentration data</span></span>
<span><span class="va">d_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Subject<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Generate the dosing data</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span> <span class="va">d_conc</span><span class="op">[</span><span class="va">d_conc</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span>,<span class="op">]</span></span>
<span><span class="va">d_dose</span><span class="op">$</span><span class="va">Time</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co">## Create a concentration object specifying the concentration, time, and</span></span>
<span><span class="co">## subject columns.  (Note that any number of grouping levels is</span></span>
<span><span class="co">## supported; you are not restricted to just grouping by subject.)</span></span>
<span><span class="va">conc_obj</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span></span>
<span>    <span class="va">d_conc</span>,</span>
<span>    <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">## Create a dosing object specifying the dose, time, and subject</span></span>
<span><span class="co">## columns.  (Note that the grouping factors should be the same as or a</span></span>
<span><span class="co">## subset of the grouping factors for concentration, and the grouping</span></span>
<span><span class="co">## columns must have the same names between concentration and dose</span></span>
<span><span class="co">## objects.)</span></span>
<span><span class="va">dose_obj</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span></span>
<span>    <span class="va">d_dose</span>,</span>
<span>    <span class="va">Dose</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">## Combine the concentration and dosing information both to</span></span>
<span><span class="co">## automatically define the intervals for NCA calculation and provide</span></span>
<span><span class="co">## doses for calculations requiring dose.</span></span>
<span><span class="va">data_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">conc_obj</span>, <span class="va">dose_obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate the NCA parameters</span></span>
<span><span class="va">results_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">data_obj</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Summarize the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  start end  N     auclast        cmax               tmax   half.life aucinf.obs</span></span>
<span><span class="co">##      0  24 12 74.6 [24.3]           .                  .           .          .</span></span>
<span><span class="co">##      0 Inf 12           . 8.65 [17.0] 1.14 [0.630, 3.55] 8.18 [2.12] 115 [28.4]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: auclast, cmax, aucinf.obs: geometric mean and geometric coefficient of variation; tmax: median and range; half.life: arithmetic mean and standard deviation; N: number of subjects</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="data-handling">Data Handling<a class="anchor" aria-label="anchor" href="#data-handling"></a>
</h2>
<p>After loading data, it must be in the right form. The minimum
requirements are that concentration, dose, and time must all be numeric
(and not factors). Grouping variables have no specific requirements;
they can be any mode.</p>
<p>Values below the limit of quantification are coded as zeros
(<code>0</code>), and missing values are coded as <code>NA</code>.</p>
</div>
<div class="section level2">
<h2 id="options-make-pknca-work-your-way">Options: Make PKNCA Work Your Way<a class="anchor" aria-label="anchor" href="#options-make-pknca-work-your-way"></a>
</h2>
<div class="section level3">
<h3 id="calculation-options-the-pknca-options-function">Calculation Options: the PKNCA.options Function<a class="anchor" aria-label="anchor" href="#calculation-options-the-pknca-options-function"></a>
</h3>
<p>Different organizations have different requirements for computation
and summarization of NCA. Options for how to perform calculations and
summaries are handled by the <code>PKNCA.options</code> command.</p>
<p>Default options have been set to commonly-used standard parameters.
The current value for options can be found by running the command with
no arguments:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PKNCA.options.html">PKNCA.options</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $adj.r.squared.factor</span></span>
<span><span class="co">## [1] 1e-04</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $max.missing</span></span>
<span><span class="co">## [1] 0.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $auc.method</span></span>
<span><span class="co">## [1] "lin up/log down"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $conc.na</span></span>
<span><span class="co">## [1] "drop"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $conc.blq</span></span>
<span><span class="co">## $conc.blq$first</span></span>
<span><span class="co">## [1] "keep"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $conc.blq$middle</span></span>
<span><span class="co">## [1] "drop"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $conc.blq$last</span></span>
<span><span class="co">## [1] "keep"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $first.tmax</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $allow.tmax.in.half.life</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $keep_interval_cols</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $min.hl.points</span></span>
<span><span class="co">## [1] 3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $min.span.ratio</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $max.aucinf.pext</span></span>
<span><span class="co">## [1] 20</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $min.hl.r.squared</span></span>
<span><span class="co">## [1] 0.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $progress</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $tau.choices</span></span>
<span><span class="co">## [1] NA</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $single.dose.aucs</span></span>
<span><span class="co">##   start end auclast aucall aumclast aumcall aucint.last aucint.last.dose</span></span>
<span><span class="co">## 1     0  24    TRUE  FALSE    FALSE   FALSE       FALSE            FALSE</span></span>
<span><span class="co">## 2     0 Inf   FALSE  FALSE    FALSE   FALSE       FALSE            FALSE</span></span>
<span><span class="co">##   aucint.all aucint.all.dose    c0  cmax  cmin  tmax tlast tfirst clast.obs</span></span>
<span><span class="co">## 1      FALSE           FALSE FALSE FALSE FALSE FALSE FALSE  FALSE     FALSE</span></span>
<span><span class="co">## 2      FALSE           FALSE FALSE  TRUE FALSE  TRUE FALSE  FALSE     FALSE</span></span>
<span><span class="co">##   cl.last cl.all     f mrt.last mrt.iv.last vss.last vss.iv.last   cav</span></span>
<span><span class="co">## 1   FALSE  FALSE FALSE    FALSE       FALSE    FALSE       FALSE FALSE</span></span>
<span><span class="co">## 2   FALSE  FALSE FALSE    FALSE       FALSE    FALSE       FALSE FALSE</span></span>
<span><span class="co">##   cav.int.last cav.int.all ctrough cstart   ptr  tlag deg.fluc swing  ceoi</span></span>
<span><span class="co">## 1        FALSE       FALSE   FALSE  FALSE FALSE FALSE    FALSE FALSE FALSE</span></span>
<span><span class="co">## 2        FALSE       FALSE   FALSE  FALSE FALSE FALSE    FALSE FALSE FALSE</span></span>
<span><span class="co">##   aucabove.predose.all aucabove.trough.all count_conc totdose    ae clr.last</span></span>
<span><span class="co">## 1                FALSE               FALSE      FALSE   FALSE FALSE    FALSE</span></span>
<span><span class="co">## 2                FALSE               FALSE      FALSE   FALSE FALSE    FALSE</span></span>
<span><span class="co">##   clr.obs clr.pred    fe sparse_auclast sparse_auc_se sparse_auc_df time_above</span></span>
<span><span class="co">## 1   FALSE    FALSE FALSE          FALSE         FALSE         FALSE      FALSE</span></span>
<span><span class="co">## 2   FALSE    FALSE FALSE          FALSE         FALSE         FALSE      FALSE</span></span>
<span><span class="co">##   aucivlast aucivall aucivint.last aucivint.all aucivpbextlast aucivpbextall</span></span>
<span><span class="co">## 1     FALSE    FALSE         FALSE        FALSE          FALSE         FALSE</span></span>
<span><span class="co">## 2     FALSE    FALSE         FALSE        FALSE          FALSE         FALSE</span></span>
<span><span class="co">##   aucivpbextint.last aucivpbextint.all half.life r.squared adj.r.squared</span></span>
<span><span class="co">## 1              FALSE             FALSE     FALSE     FALSE         FALSE</span></span>
<span><span class="co">## 2              FALSE             FALSE      TRUE     FALSE         FALSE</span></span>
<span><span class="co">##   lambda.z lambda.z.time.first lambda.z.n.points clast.pred span.ratio</span></span>
<span><span class="co">## 1    FALSE               FALSE             FALSE      FALSE      FALSE</span></span>
<span><span class="co">## 2    FALSE               FALSE             FALSE      FALSE      FALSE</span></span>
<span><span class="co">##   thalf.eff.last thalf.eff.iv.last kel.last kel.iv.last aucinf.obs aucinf.pred</span></span>
<span><span class="co">## 1          FALSE             FALSE    FALSE       FALSE      FALSE       FALSE</span></span>
<span><span class="co">## 2          FALSE             FALSE    FALSE       FALSE       TRUE       FALSE</span></span>
<span><span class="co">##   aumcinf.obs aumcinf.pred aucint.inf.obs aucint.inf.obs.dose aucint.inf.pred</span></span>
<span><span class="co">## 1       FALSE        FALSE          FALSE               FALSE           FALSE</span></span>
<span><span class="co">## 2       FALSE        FALSE          FALSE               FALSE           FALSE</span></span>
<span><span class="co">##   aucint.inf.pred.dose aucivinf.obs aucivinf.pred aucivpbextinf.obs</span></span>
<span><span class="co">## 1                FALSE        FALSE         FALSE             FALSE</span></span>
<span><span class="co">## 2                FALSE        FALSE         FALSE             FALSE</span></span>
<span><span class="co">##   aucivpbextinf.pred aucpext.obs aucpext.pred cl.obs cl.pred mrt.obs mrt.pred</span></span>
<span><span class="co">## 1              FALSE       FALSE        FALSE  FALSE   FALSE   FALSE    FALSE</span></span>
<span><span class="co">## 2              FALSE       FALSE        FALSE  FALSE   FALSE   FALSE    FALSE</span></span>
<span><span class="co">##   mrt.iv.obs mrt.iv.pred mrt.md.obs mrt.md.pred vz.obs vz.pred vss.obs vss.pred</span></span>
<span><span class="co">## 1      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE   FALSE    FALSE</span></span>
<span><span class="co">## 2      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE   FALSE    FALSE</span></span>
<span><span class="co">##   vss.iv.obs vss.iv.pred vss.md.obs vss.md.pred cav.int.inf.obs</span></span>
<span><span class="co">## 1      FALSE       FALSE      FALSE       FALSE           FALSE</span></span>
<span><span class="co">## 2      FALSE       FALSE      FALSE       FALSE           FALSE</span></span>
<span><span class="co">##   cav.int.inf.pred thalf.eff.obs thalf.eff.pred thalf.eff.iv.obs</span></span>
<span><span class="co">## 1            FALSE         FALSE          FALSE            FALSE</span></span>
<span><span class="co">## 2            FALSE         FALSE          FALSE            FALSE</span></span>
<span><span class="co">##   thalf.eff.iv.pred kel.obs kel.pred kel.iv.obs kel.iv.pred auclast.dn</span></span>
<span><span class="co">## 1             FALSE   FALSE    FALSE      FALSE       FALSE      FALSE</span></span>
<span><span class="co">## 2             FALSE   FALSE    FALSE      FALSE       FALSE      FALSE</span></span>
<span><span class="co">##   aucall.dn aucinf.obs.dn aucinf.pred.dn aumclast.dn aumcall.dn aumcinf.obs.dn</span></span>
<span><span class="co">## 1     FALSE         FALSE          FALSE       FALSE      FALSE          FALSE</span></span>
<span><span class="co">## 2     FALSE         FALSE          FALSE       FALSE      FALSE          FALSE</span></span>
<span><span class="co">##   aumcinf.pred.dn cmax.dn cmin.dn clast.obs.dn clast.pred.dn cav.dn ctrough.dn</span></span>
<span><span class="co">## 1           FALSE   FALSE   FALSE        FALSE         FALSE  FALSE      FALSE</span></span>
<span><span class="co">## 2           FALSE   FALSE   FALSE        FALSE         FALSE  FALSE      FALSE</span></span></code></pre>
<p>And, to reset the current values to the library defaults, run the
function with the default argument set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PKNCA.options.html">PKNCA.options</a></span><span class="op">(</span>default<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Each of the options is documented where it is used; for example, the
first.tmax option is documented in the <code>pk.calc.tmax</code>
function.</p>
</div>
<div class="section level3">
<h3 id="summarization-options-the-pknca-set-summary-function">Summarization Options: the PKNCA.set.summary Function<a class="anchor" aria-label="anchor" href="#summarization-options-the-pknca-set-summary-function"></a>
</h3>
<p>On top of methods of calculation, summarization method preferences
differ. Typical summarization preferences include selection of the
measurement of central tendency and dispersion, handling of missing
values, handling of values below the limit of quantification, and more.
Beyond the method for summarization, presentation is managed through
user preferences. Presentation is typically controlled by rounding to
either a defined number of decimal places or significant figures.</p>
<p>An example is that C<sub>max</sub> may be summarized by the geometric
mean with the geometric CV using three significant figures, and having a
summary result requires that at least half of the available values are
present (not missing). The code below will set this example.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PKNCA.set.summary.html">PKNCA.set.summary</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"cmax"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"geometric mean and geometric coefficient of variation"</span>,</span>
<span>  point <span class="op">=</span> <span class="va">business.geomean</span>,</span>
<span>  spread <span class="op">=</span> <span class="va">business.geocv</span>,</span>
<span>  rounding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>signif<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Another example is that T<sub>max</sub> is usually summarized by the
median and range, and as measurements are often taken with minute
resolution and recorded in hours, reporting is usually to the second
decimal place.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PKNCA.set.summary.html">PKNCA.set.summary</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"tmax"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"median and range"</span>,</span>
<span>  point <span class="op">=</span> <span class="va">business.median</span>,</span>
<span>  spread <span class="op">=</span> <span class="va">business.range</span>,</span>
<span>  rounding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>round<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If the functions or default rounding options provided in the library
do not meet the summarization needs, a user-supplied function can be
used for rounding.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">median_na</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">quantprob_na</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/PKNCA.set.summary.html">PKNCA.set.summary</a></span><span class="op">(</span></span>
<span>  name<span class="op">=</span><span class="st">"auclast"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"median and 5th to 95th percentile"</span>,</span>
<span>  point<span class="op">=</span><span class="va">median_na</span>,</span>
<span>  spread<span class="op">=</span><span class="va">quantprob_na</span>,</span>
<span>  rounding<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>signif<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In some cases multiple parameters may need the same summary functions
(as often occurs with simulated data). Many parameters can be set
simultaneously by specifying a vector of <code>name</code>s.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">median_na</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">quantprob_na</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/PKNCA.set.summary.html">PKNCA.set.summary</a></span><span class="op">(</span></span>
<span>  name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auclast"</span>, <span class="st">"cmax"</span>, <span class="st">"tmax"</span>, <span class="st">"half.life"</span>, <span class="st">"aucinf.pred"</span><span class="op">)</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"median and 5th to 95th percentile"</span>,</span>
<span>  point<span class="op">=</span><span class="va">median_na</span>,</span>
<span>  spread<span class="op">=</span><span class="va">quantprob_na</span>,</span>
<span>  rounding<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>signif<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="grouping-nca-data">Grouping NCA Data<a class="anchor" aria-label="anchor" href="#grouping-nca-data"></a>
</h2>
<p>As described in the <a href="#quick-start">quick start</a>,
concentration and dose data are generally grouped to identify how to
separate the data. Typical groups for concentration data include study,
treatment, subject, and analyte. Typical groups for dose data include
study, treatment, and subject. By default, summaries are produced based
on the concentration groups dropping the subject (so that averages are
taken across subjects within the other parameters).</p>
<p>The quick start example can be extended to include multiple analytes
as follows. The only difference is the <code>/analyte</code> formula
element in the concentration data. The reason for the slash instead of
the plus is that the last element before a slash is assumed to be the
subject, and as noted before, the subject is (by default) excluded from
the summary grouping (so that summaries are grouped by study, treatment,
etc., but not by subject).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Generate a faux multi-study, multi-analyte dataset.</span></span>
<span><span class="va">d_conc_parent</span> <span class="op">&lt;-</span> <span class="va">d_conc</span></span>
<span><span class="va">d_conc_parent</span><span class="op">$</span><span class="va">Subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">d_conc_parent</span><span class="op">$</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d_conc_parent</span><span class="op">$</span><span class="va">Study</span> <span class="op">&lt;-</span> <span class="va">d_conc_parent</span><span class="op">$</span><span class="va">Subject</span> <span class="op">&lt;=</span> <span class="fl">6</span></span>
<span><span class="va">d_conc_parent</span><span class="op">$</span><span class="va">Analyte</span> <span class="op">&lt;-</span> <span class="st">"Parent"</span></span>
<span><span class="va">d_conc_metabolite</span> <span class="op">&lt;-</span> <span class="va">d_conc_parent</span></span>
<span><span class="va">d_conc_metabolite</span><span class="op">$</span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="va">d_conc_metabolite</span><span class="op">$</span><span class="va">conc</span><span class="op">/</span><span class="fl">2</span></span>
<span><span class="va">d_conc_metabolite</span><span class="op">$</span><span class="va">Analyte</span> <span class="op">&lt;-</span> <span class="st">"Metabolite"</span></span>
<span><span class="va">d_conc_both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">d_conc_parent</span>, <span class="va">d_conc_metabolite</span><span class="op">)</span></span>
<span><span class="va">d_conc_both</span> <span class="op">&lt;-</span> <span class="va">d_conc_both</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">d_conc_both</span>, <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">Study</span>, <span class="va">Subject</span>, <span class="va">Time</span>, <span class="va">Analyte</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">d_dose_both</span> <span class="op">&lt;-</span> <span class="va">d_conc_both</span><span class="op">[</span><span class="va">d_conc_both</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">d_conc_both</span><span class="op">$</span><span class="va">Analyte</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Parent"</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Study"</span>, <span class="st">"Subject"</span>, <span class="st">"Dose"</span>, <span class="st">"Time"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Create a concentration object specifying the concentration, time,</span></span>
<span><span class="co">## study, and subject columns.  (Note that any number of grouping</span></span>
<span><span class="co">## levels is supporting; you are not restricted to this list.)</span></span>
<span><span class="va">conc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">d_conc_both</span>,</span>
<span>                      <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Study</span><span class="op">+</span><span class="va">Subject</span><span class="op">/</span><span class="va">Analyte</span><span class="op">)</span></span>
<span><span class="co">## Create a dosing object specifying the dose, time, study, and</span></span>
<span><span class="co">## subject columns.  (Note that the grouping factors should be a</span></span>
<span><span class="co">## subset of the grouping factors for concentration, and the columns</span></span>
<span><span class="co">## must have the same names between concentration and dose objects.)</span></span>
<span><span class="va">dose_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">d_dose_both</span>,</span>
<span>                     <span class="va">Dose</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Study</span><span class="op">+</span><span class="va">Subject</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform and summarize the PK data as previously described</span></span>
<span><span class="va">data_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">conc_obj</span>, <span class="va">dose_obj</span><span class="op">)</span></span>
<span><span class="va">results_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">data_obj</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results_obj</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="selecting-calculation-intervals">Selecting Calculation Intervals<a class="anchor" aria-label="anchor" href="#selecting-calculation-intervals"></a>
</h2>
<p>All NCA calculations require the interval over which they are
calculated. When the concentration and dosing information are combined
to the PKNCAdata object, intervals are automatically determined. The
exception to this automatic determination is if the user provides
intervals.</p>
<p>When selected either automatically or manually, intervals define at
minimum a start time, an end time, and the parameters to be calculated.
The parameter list is available from the <code>get.interval.cols</code>
function. The parameters requested are specified by setting the entry in
a data.frame as requested.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intervals</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>    cmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    tmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    auclast<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    aucinf.obs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Intervals like the above is sufficient for designs with a single type
of treatment– like single doses. For more complex treatments in a single
analysis, like the combination of single and multiple doses, include a
treatment column matching the treatment column name from the
concentration data set. See the <a href="#manual-interval-specification">Manual Interval Specification</a>
section below for more details.</p>
<div class="section level3">
<h3 id="selection-of-data-used-for-calculation">Selection of Data Used for Calculation<a class="anchor" aria-label="anchor" href="#selection-of-data-used-for-calculation"></a>
</h3>
<p>When choosing which data is used for a calculation, PKNCA will never
look beyond the data specified in the group and interval. Groups are
defined by the call to the <code>PKNCAconc</code> function, and they
will typically define the measurement of a single analyte from a single
individual receiving a single treatment. Intervals are subsets within a
group by start and end time. PKNCA never examines data outside of the
group and interval for standard NCA calculations. As an example, with
data from 0 to 48 hours and an interval set to <code>start</code> at 0
and <code>end</code> at 24 with the calculation of
<code>aucinf.obs</code>, any data after 24 hours will not be used for
the half-life or AUC<sub>inf</sub> calculations.</p>
<p>A few functions look at data outside of a single interval, but these
functions do not look at data outside of a single group, and these
functions are typically used during preparation for NCA calculations not
for the calculations themselves. Functions that look a group as a whole
include <code>choose.auc.intervals</code>, <code>find.tau</code>, and
<code>pk.tss</code>.</p>
</div>
<div class="section level3">
<h3 id="automatic-interval-determination">Automatic Interval Determination<a class="anchor" aria-label="anchor" href="#automatic-interval-determination"></a>
</h3>
<p>If intervals are not specified when combining the concentration and
dosing data, they will automatically be found from the concentration and
dosing data.</p>
<p>Single dose data has a simple interval selection: the option
<code>single.dose.aucs</code> is used from the
<code>PKNCA.options</code>.</p>
<table class="table">
<colgroup>
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="1%">
<col width="0%">
<col width="0%">
<col width="0%">
<col width="1%">
<col width="0%">
<col width="0%">
</colgroup>
<thead><tr class="header">
<th align="right">start</th>
<th align="right">end</th>
<th align="left">auclast</th>
<th align="left">aucall</th>
<th align="left">aumclast</th>
<th align="left">aumcall</th>
<th align="left">aucint.last</th>
<th align="left">aucint.last.dose</th>
<th align="left">aucint.all</th>
<th align="left">aucint.all.dose</th>
<th align="left">c0</th>
<th align="left">cmax</th>
<th align="left">cmin</th>
<th align="left">tmax</th>
<th align="left">tlast</th>
<th align="left">tfirst</th>
<th align="left">clast.obs</th>
<th align="left">cl.last</th>
<th align="left">cl.all</th>
<th align="left">f</th>
<th align="left">mrt.last</th>
<th align="left">mrt.iv.last</th>
<th align="left">vss.last</th>
<th align="left">vss.iv.last</th>
<th align="left">cav</th>
<th align="left">cav.int.last</th>
<th align="left">cav.int.all</th>
<th align="left">ctrough</th>
<th align="left">cstart</th>
<th align="left">ptr</th>
<th align="left">tlag</th>
<th align="left">deg.fluc</th>
<th align="left">swing</th>
<th align="left">ceoi</th>
<th align="left">aucabove.predose.all</th>
<th align="left">aucabove.trough.all</th>
<th align="left">count_conc</th>
<th align="left">totdose</th>
<th align="left">ae</th>
<th align="left">clr.last</th>
<th align="left">clr.obs</th>
<th align="left">clr.pred</th>
<th align="left">fe</th>
<th align="left">sparse_auclast</th>
<th align="left">sparse_auc_se</th>
<th align="left">sparse_auc_df</th>
<th align="left">time_above</th>
<th align="left">aucivlast</th>
<th align="left">aucivall</th>
<th align="left">aucivint.last</th>
<th align="left">aucivint.all</th>
<th align="left">aucivpbextlast</th>
<th align="left">aucivpbextall</th>
<th align="left">aucivpbextint.last</th>
<th align="left">aucivpbextint.all</th>
<th align="left">half.life</th>
<th align="left">r.squared</th>
<th align="left">adj.r.squared</th>
<th align="left">lambda.z</th>
<th align="left">lambda.z.time.first</th>
<th align="left">lambda.z.n.points</th>
<th align="left">clast.pred</th>
<th align="left">span.ratio</th>
<th align="left">thalf.eff.last</th>
<th align="left">thalf.eff.iv.last</th>
<th align="left">kel.last</th>
<th align="left">kel.iv.last</th>
<th align="left">aucinf.obs</th>
<th align="left">aucinf.pred</th>
<th align="left">aumcinf.obs</th>
<th align="left">aumcinf.pred</th>
<th align="left">aucint.inf.obs</th>
<th align="left">aucint.inf.obs.dose</th>
<th align="left">aucint.inf.pred</th>
<th align="left">aucint.inf.pred.dose</th>
<th align="left">aucivinf.obs</th>
<th align="left">aucivinf.pred</th>
<th align="left">aucivpbextinf.obs</th>
<th align="left">aucivpbextinf.pred</th>
<th align="left">aucpext.obs</th>
<th align="left">aucpext.pred</th>
<th align="left">cl.obs</th>
<th align="left">cl.pred</th>
<th align="left">mrt.obs</th>
<th align="left">mrt.pred</th>
<th align="left">mrt.iv.obs</th>
<th align="left">mrt.iv.pred</th>
<th align="left">mrt.md.obs</th>
<th align="left">mrt.md.pred</th>
<th align="left">vz.obs</th>
<th align="left">vz.pred</th>
<th align="left">vss.obs</th>
<th align="left">vss.pred</th>
<th align="left">vss.iv.obs</th>
<th align="left">vss.iv.pred</th>
<th align="left">vss.md.obs</th>
<th align="left">vss.md.pred</th>
<th align="left">cav.int.inf.obs</th>
<th align="left">cav.int.inf.pred</th>
<th align="left">thalf.eff.obs</th>
<th align="left">thalf.eff.pred</th>
<th align="left">thalf.eff.iv.obs</th>
<th align="left">thalf.eff.iv.pred</th>
<th align="left">kel.obs</th>
<th align="left">kel.pred</th>
<th align="left">kel.iv.obs</th>
<th align="left">kel.iv.pred</th>
<th align="left">auclast.dn</th>
<th align="left">aucall.dn</th>
<th align="left">aucinf.obs.dn</th>
<th align="left">aucinf.pred.dn</th>
<th align="left">aumclast.dn</th>
<th align="left">aumcall.dn</th>
<th align="left">aumcinf.obs.dn</th>
<th align="left">aumcinf.pred.dn</th>
<th align="left">cmax.dn</th>
<th align="left">cmin.dn</th>
<th align="left">clast.obs.dn</th>
<th align="left">clast.pred.dn</th>
<th align="left">cav.dn</th>
<th align="left">ctrough.dn</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">24</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">Inf</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>For multiple-dose studies, PKNCA selects one group at a time and
compares the concentration and dosing times. When there is a
concentration measurement between doses, an interval row is added. The
dosing interval
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>)
is determined by looking for pattern repeats within the dosing data
using the <code>find.tau</code> function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## find.tau can work when all doses have the same interval...</span></span>
<span><span class="va">dose_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">168</span>, by<span class="op">=</span><span class="fl">24</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dose_times</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]   0  24  48  72  96 120 144 168</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">PKNCA</span><span class="fu">::</span><span class="fu"><a href="../reference/find.tau.html">find.tau</a></span><span class="op">(</span><span class="va">dose_times</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 24</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## or when the doses have mixed intervals (10 and 24 hours).</span></span>
<span><span class="va">dose_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">168</span>, by<span class="op">=</span><span class="fl">24</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">178</span>, by<span class="op">=</span><span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dose_times</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1]   0  10  24  34  48  58  72  82  96 106 120 130 144 154 168 178</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">PKNCA</span><span class="fu">::</span><span class="fu"><a href="../reference/find.tau.html">find.tau</a></span><span class="op">(</span><span class="va">dose_times</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 24</span></span></code></pre>
<p>After finding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>,
PKNCA will also look after the last dose (or the beginning of the last
dosing interval), and two additional intervals may be added:</p>
<ul>
<li>one interval for the dosing interval after the beginning of the last
dosing interval (if there are concentrations measured in the
interval)</li>
<li>one interval for the half-life after the last dosing interval (if
there are concentration more than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
after the beginning of the last interval).</li>
</ul>
<p>One consequence of automatic interval selection is that many rows are
generated for intervals; one row is generated per interval per subject.
The benefit of the method producing a large number of rows is that it is
fully flexible to the actual study results. If a subject has a different
schedule than the others for the same treatment (e.g. measurements that
were nominally scheduled for day 14 occurred on day 13), those
differences will be found.</p>
</div>
<div class="section level3">
<h3 id="manual-interval-specification">Manual Interval Specification<a class="anchor" aria-label="anchor" href="#manual-interval-specification"></a>
</h3>
<p>Intervals can also be specified manually. Two use cases are common
for manual specification: fully manual (never requesting the automatic
intervals) and updating the automatic intervals.</p>
<p>Fully manual intervals can be specified by providing it to the
<code>PKNCAdata</code> call.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">intervals_manual</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>    cmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    tmax<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    auclast<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    aucinf.obs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">data_obj</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span></span>
<span>    <span class="va">conc_obj</span>, <span class="va">dose_obj</span>, </span>
<span>    intervals<span class="op">=</span><span class="va">intervals_manual</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>To update the automatically-selected intervals, extract the
intervals, modify them, and put them back.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">conc_obj</span>, <span class="va">dose_obj</span><span class="op">)</span></span>
<span><span class="va">intervals_manual</span> <span class="op">&lt;-</span> <span class="va">data_obj</span><span class="op">$</span><span class="va">intervals</span></span>
<span><span class="va">intervals_manual</span><span class="op">$</span><span class="va">aucinf.obs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">data_obj</span><span class="op">$</span><span class="va">intervals</span> <span class="op">&lt;-</span> <span class="va">intervals_manual</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="keeping-a-column-from-intervals">Keeping a column from intervals<a class="anchor" aria-label="anchor" href="#keeping-a-column-from-intervals"></a>
</h3>
<p>When computing NCA using actual times, grouping by start and end time
in summaries (see layer) is less helpful because everyone could have
different start and end times. So, you may keep the interval columns
using the option <code>"keep_interval_cols"</code> as follows (where
“dosetype” must be a column name in the intervals):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">conc_obj</span>, <span class="va">dose_obj</span>, options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>keep_interval_cols <span class="op">=</span> <span class="st">"dosetype"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summarizing-results">Summarizing results<a class="anchor" aria-label="anchor" href="#summarizing-results"></a>
</h2>
<p>When NCA has been calculated, you can summarize the results with the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span></code></pre></div>
<p>By default, it will count the number of unique subjects
(<code>N</code>) in the summary, and when the number of subjects differs
from the number of measurements included in a summary (<code>n</code>),
it will summarize <code>n</code> for the given parameters. Note that
counting of “n” includes all non-missing values that were not excluded
from summarization; this will included all zeros that are e.g. excluded
from geometric statistics.</p>
<p>Edge cases like two unique subjects where one has an excluded value
and one has duplicated values (<code>N = 2</code> and <code>n = 2</code>
even though both measurements come from a single subject) are to be
handled by the user.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
