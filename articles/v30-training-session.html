<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="PKNCA">
<title>PKNCA Training Sessions • PKNCA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PKNCA Training Sessions">
<meta property="og:description" content="PKNCA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PKNCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v01-introduction-and-usage.html">Introduction to PKNCA and Usage Instructions</a>
    <a class="dropdown-item" href="../articles/v02-example-theophylline.html">Computing NCA Parameters for Theophylline</a>
    <a class="dropdown-item" href="../articles/v03-selection-of-calculation-intervals.html">Selection of Calculation Intervals</a>
    <a class="dropdown-item" href="../articles/v04-sparse.html">Sparse NCA Calculations</a>
    <a class="dropdown-item" href="../articles/v05-auc-calculation-with-PKNCA.html">AUC Calculation with PKNCA</a>
    <a class="dropdown-item" href="../articles/v06-half-life-calculation.html">Half-Life Calculation</a>
    <a class="dropdown-item" href="../articles/v07-post-processing.html">Post-Processing</a>
    <a class="dropdown-item" href="../articles/v07-unit-conversion.html">Unit Assignment and Conversion with PKNCA</a>
    <a class="dropdown-item" href="../articles/v08-data-imputation.html">Data Imputation</a>
    <a class="dropdown-item" href="../articles/v20-superposition.html">Superposition of Pharmacokinetic Data</a>
    <a class="dropdown-item" href="../articles/v21-methods-for-dose-aware-interpolation-and-extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a>
    <a class="dropdown-item" href="../articles/v22-time-to-steady-state.html">Noncompartmental evaluation of time to steady-state</a>
    <a class="dropdown-item" href="../articles/v30-training-session.html">PKNCA Training Sessions</a>
    <a class="dropdown-item" href="../articles/v40-options-for-controlling-PKNCA.html">Options for Controlling PKNCA</a>
    <a class="dropdown-item" href="../articles/v60-PKNCA-validation.html">PKNCA Validation</a>
    <a class="dropdown-item" href="../articles/v80-writing-parameter-functions.html">Writing PKNCA Parameter Functions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/billdenney/pknca/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>PKNCA Training Sessions</h1>
                        <h4 data-toc-skip class="author">William
Denney</h4>
            
            <h4 data-toc-skip class="date">19 November 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/billdenney/pknca/blob/HEAD/vignettes/v30-training-session.Rmd" class="external-link"><code>vignettes/v30-training-session.Rmd</code></a></small>
      <div class="d-none name"><code>v30-training-session.Rmd</code></div>
    </div>

    
    
<style>
.forceBreak { -webkit-column-break-after: always; break-after: column; }

<!-- from https://stackoverflow.com/questions/1909648/stacking-divs-on-top-of-each-other -->
.container {
  width: 300px;
  height: 300px;
  margin: 0 auto;
  background-color: yellow;
  /* important part */
  display: grid;
  place-items: center;
  grid-template-areas: "inner-div";
}

.inner {
  /* important part */
  grid-area: inner-div;
}

.bigStrikethroughOuter {
  <!-- text-decoration: line-through; -->
  font-size: 8em;
  text-align: center;
  color: red;
  background: 
  linear-gradient(to top left,
    transparent 0%,
    transparent calc(50% - 0.05em),
    red calc(50% - 0.05em),
    red 50%,
    red calc(50% + 0.05em),
    transparent calc(50% + 0.05em),
    transparent 100%),
  linear-gradient(to top right,
    transparent 0%,
    transparent calc(50% - 0.05em),
    red calc(50% - 0.05em),
    red 50%,
    red calc(50% + 0.05em),
    transparent calc(50% + 0.05em),
    transparent 100%);
}

.bigStrikethroughInner {
  color: blue;
  font-size: 8em;
}

.autoImageWidth {
  width: auto !important; /*override the width below*/
  max-width: 100%;
  float: left;
  clear: both;
  text-align: center;
}

<!-- imessages -->

.imessage {
  font-family: helvetica;
  display: flex ;
  flex-direction: column;
  align-items: center;
}

.chat {
  width: 300px;
  border: solid 1px #EEE;
  display: flex;
  flex-direction: column;
  padding: 10px;
}

.messages {
  margin-top: 30px;
  display: flex;
  flex-direction: column;
}

.message {
  border-radius: 20px;
  padding: 8px 15px;
  margin-top: 5px;
  margin-bottom: 5px;
  display: inline-block;
}

.yours {
  align-items: flex-start;
}

.yours .message {
  margin-right: 25%;
  background-color: #eee;
  position: relative;
}

.yours .message.last:before {
  content: "";
  position: absolute;
  z-index: 0;
  bottom: 0;
  left: -7px;
  height: 20px;
  width: 20px;
  background: #eee;
  border-bottom-right-radius: 15px;
}
.yours .message.last:after {
  content: "";
  position: absolute;
  z-index: 1;
  bottom: 0;
  left: -10px;
  width: 10px;
  height: 20px;
  background: white;
  border-bottom-right-radius: 10px;
}

.mine {
  align-items: flex-end;
}

.mine .message {
  color: white;
  margin-left: 25%;
  background: linear-gradient(to bottom, #00D0EA 0%, #0085D1 100%);
  background-attachment: fixed;
  position: relative;
}

.mine .message.last:before {
  content: "";
  position: absolute;
  z-index: 0;
  bottom: 0;
  right: -8px;
  height: 20px;
  width: 20px;
  background: linear-gradient(to bottom, #00D0EA 0%, #0085D1 100%);
  background-attachment: fixed;
  border-bottom-left-radius: 15px;
}

.mine .message.last:after {
  content: "";
  position: absolute;
  z-index: 1;
  bottom: 0;
  right: -10px;
  width: 10px;
  height: 20px;
  background: white;
  border-bottom-left-radius: 10px;
}

</style>
<div class="section level2">
<h2 id="introduction-to-pknca-and-basics-of-its-use">Introduction to PKNCA and Basics of Its Use<a class="anchor" aria-label="anchor" href="#introduction-to-pknca-and-basics-of-its-use"></a>
</h2>
<p>Creation of these materials were supported by funding from the Metrum
Research Group.</p>
<div class="section level3">
<h3 class="build smaller" id="introduction-to-pknca">Introduction to PKNCA<a class="anchor" aria-label="anchor" href="#introduction-to-pknca"></a>
</h3>
<p>PKNCA is a tool for calculating noncompartmental analysis (NCA)
results for pharmacokinetic (PK) data.</p>
<p>… but, you already knew that or you wouldn’t be here.</p>
<p>PKNCA has several foci:</p>
<ul>
<li>be regulatory-ready
<ul>
<li>it has approximately 100% test coverage.</li>
</ul>
</li>
<li>be reproducible
<ul>
<li>it has a focus on being scriptable.</li>
</ul>
</li>
<li>get the right answer or none at all
<ul>
<li>it will try to know what you want,</li>
<li>but all decisions can be overridden, and</li>
<li>if there is a question that may cause an error or an unanticipated
result, either no result will output or an error will be raised.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 class="build" id="enjoy">Enjoy!<a class="anchor" aria-label="anchor" href="#enjoy"></a>
</h3>
<p>I hope that you have a whale of a good time during this training.</p>
<p><img src="https://apps-afsc.fisheries.noaa.gov/Quarterly/amj2005/images/killerwhales.jpg"></p>
<p>(Foreshadowing…)</p>
</div>
<div class="section level3">
<h3 id="some-nca-definitions">Some NCA Definitions<a class="anchor" aria-label="anchor" href="#some-nca-definitions"></a>
</h3>
<ul>
<li>
<strong>C<sub>max</sub></strong>: The maximum observed
concentration</li>
<li>
<strong>T<sub>max</sub></strong>: The time of the maximum observed
concentration</li>
<li>
<strong>t<sub>last</sub></strong>: The time of the last
concentration above the limit of quantification</li>
<li>
<strong>AUC</strong>: Area under the concentration-time curve. Some
important AUC variants are:
<ul>
<li>
<strong>AUC<sub>last</sub></strong>: AUC from time zero to
t<sub>last</sub>
</li>
<li>
<strong>AUC<sub>int</sub></strong>: AUC from time zero to the end of
an interval of time, often extrapolated or interpolated
(e.g. AUC<sub>0-24hr</sub>)</li>
<li>
<strong>AUC<sub>∞</sub></strong>: AUC from time zero to
t<sub>last</sub> then extrapolated from t<sub>last</sub> to time
infinity using the half life</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="dataset-basics">Dataset Basics<a class="anchor" aria-label="anchor" href="#dataset-basics"></a>
</h2>
<div class="section level3">
<h3 id="nca-data-are-not-tidy-as-a-single-dataset">NCA Data are Not Tidy <strong><em>as a Single
Dataset</em></strong><a class="anchor" aria-label="anchor" href="#nca-data-are-not-tidy-as-a-single-dataset"></a>
</h3>
<p>“Tidy datasets… have a specific structure: each variable is a column,
each observation is a row, and each type of observational unit is a
table.” - Hadley Wickham (<a href="https://doi.org/10.18637/jss.v059.i10" class="external-link uri">https://doi.org/10.18637/jss.v059.i10</a>)</p>
<p>CDISC has NCA tidied, and PKNCA follows that model:</p>
<ul>
<li>concentration-time is a dataset (PC domain; <code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code>
object)</li>
<li>dose-time is a dataset (EX/EC domains; <code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>
object)</li>
<li>NCA results are a dataset (PP domain; <code><a href="../reference/pk.nca.html">pk.nca()</a></code>
output)</li>
</ul>
</div>
<div class="section level3">
<h3 id="dataset-basics-minimum-data">Dataset Basics: Minimum data<a class="anchor" aria-label="anchor" href="#dataset-basics-minimum-data"></a>
</h3>
<p>PKNCA requires at minimum concentration, time, and what you want to
calculate.</p>
<p><img src="v30-training-session_files/figure-html/unnamed-chunk-1-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="dataset-basics-what-columns-are-needed">Dataset Basics: What columns are needed?<a class="anchor" aria-label="anchor" href="#dataset-basics-what-columns-are-needed"></a>
</h3>
<p>Column names are provided by the input to <code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code>
and <code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>; they are not hard-coded.</p>
<p>Columns that can be used include:</p>
<ul>
<li>
<code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code>: concentration, time, groups; data
exclusions; half-life inclusion and exclusion</li>
<li>
<code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>: dose, time, groups; route, rate/duration
of infusion; data exclusions</li>
<li>intervals given to <code><a href="../reference/PKNCAdata.html">PKNCAdata()</a></code>: groups, start, end, and
any NCA parameters to calculate</li>
</ul>
</div>
<div class="section level3">
<h3 id="dataset-basics-example-data">Dataset Basics: Example data<a class="anchor" aria-label="anchor" href="#dataset-basics-example-data"></a>
</h3>
<p>In the following slides, abbreviated data from an example study where
two treatments (“A” and “B”) are administered to two subjects (1 and
2).</p>
<ul>
<li>For PKNCA, the groups will be <strong>Treatment</strong> and
<strong>Subject</strong>.
<ul>
<li>PKNCA considers groups in order with the subject identifier as the
last group (or the last group before a forward slash, <code>/</code>, if
<code>/</code> is present).</li>
<li>When indicated in order (<code>...|Treatment+Subject</code>), PKNCA
automatically knows to keep <strong>Treatment</strong> and drop
<strong>Subject</strong> for summaries (more on that later).</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 class="columns-2" id="dataset-basics-example-concentration-data">Dataset Basics: Example concentration data<a class="anchor" aria-label="anchor" href="#dataset-basics-example-concentration-data"></a>
</h3>
<table style="width:53%;" class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="9%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Treatment</th>
<th align="center">Time</th>
<th align="center">Conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">A</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">A</td>
<td align="center">2</td>
<td align="center">2.143</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">A</td>
<td align="center">8</td>
<td align="center">0.4696</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">B</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">B</td>
<td align="center">2</td>
<td align="center">2.179</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">B</td>
<td align="center">8</td>
<td align="center">0.4852</td>
</tr>
</tbody>
</table>
<p class="forceBreak">
</p>
<table style="width:53%;" class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="9%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Treatment</th>
<th align="center">Time</th>
<th align="center">Conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2</td>
<td align="center">A</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">A</td>
<td align="center">2</td>
<td align="center">1.937</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">A</td>
<td align="center">8</td>
<td align="center">0.4929</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">B</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">B</td>
<td align="center">2</td>
<td align="center">2.127</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">B</td>
<td align="center">8</td>
<td align="center">0.4804</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="dataset-basics-example-dosing-data">Dataset Basics: Example dosing data<a class="anchor" aria-label="anchor" href="#dataset-basics-example-dosing-data"></a>
</h3>
<table style="width:50%;" class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Treatment</th>
<th align="center">Time</th>
<th align="center">Dose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">A</td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">B</td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
<p class="forceBreak">
</p>
<table style="width:50%;" class="table">
<colgroup>
<col width="13%">
<col width="16%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Treatment</th>
<th align="center">Time</th>
<th align="center">Dose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2</td>
<td align="center">A</td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">B</td>
<td align="center">0</td>
<td align="center">10</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="dataset-basics-example-interval-data">Dataset Basics: Example interval data<a class="anchor" aria-label="anchor" href="#dataset-basics-example-interval-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_interval_1</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fl">8</span>,</span>
<span>    cmax<span class="op">=</span><span class="cn">TRUE</span>, tmax<span class="op">=</span><span class="cn">TRUE</span>, auclast<span class="op">=</span><span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<table style="width:53%;" class="table">
<colgroup>
<col width="11%">
<col width="8%">
<col width="9%">
<col width="9%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">cmax</th>
<th align="center">tmax</th>
<th align="center">auclast</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">0</td>
<td align="center">8</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
</tr></tbody>
</table>
<p>Groups are not required, if you want the same intervals calculated
for each group.</p>
</div>
<div class="section level3">
<h3 id="hands-on-first-nca-calculation-with-pknca">Hands-on: First NCA calculation with PKNCA<a class="anchor" aria-label="anchor" href="#hands-on-first-nca-calculation-with-pknca"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/" class="external-link">PKNCA</a></span><span class="op">)</span></span>
<span><span class="co"># Concentration data setup</span></span>
<span><span class="va">d_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span></span>
<span><span class="co"># Setup intervals for calculation</span></span>
<span><span class="va">d_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fl">24</span>, cmax<span class="op">=</span><span class="cn">TRUE</span>, tmax<span class="op">=</span><span class="cn">TRUE</span>, auclast<span class="op">=</span><span class="cn">TRUE</span>, aucint.inf.obs<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Combine concentration and dose</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, intervals<span class="op">=</span><span class="va">d_intervals</span><span class="op">)</span></span>
<span><span class="co"># Calculate the results (suppressMessages() hides a message that isn't needed now)</span></span>
<span><span class="va">o_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># summary(o_result)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="pknca-functions">PKNCA Functions<a class="anchor" aria-label="anchor" href="#pknca-functions"></a>
</h2>
<div class="section level3">
<h3 id="what-functions-are-the-most-used">What functions are the most used?<a class="anchor" aria-label="anchor" href="#what-functions-are-the-most-used"></a>
</h3>
<ul>
<li>
<code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code>: define a concentration-time
<code>PKNCAconc</code> object
<ul>
<li>All information about concentration data are given: concentration,
time</li>
<li>Optional information includes: grouping information (usually given),
data to exclude, half-life inclusion and exclusion columns</li>
</ul>
</li>
<li>
<code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>: define a dose-time <code>PKNCAdose</code>
object (optional)
<ul>
<li>dose amount and time are both optional</li>
<li>Optional information includes: rate or duration of infusion, data to
exclude</li>
</ul>
</li>
<li>
<code><a href="../reference/PKNCAdata.html">PKNCAdata()</a></code>: combine <code>PKNCAconc</code>, optionally
<code>PKNCAdose</code>, and optionally <code>intervals</code> into a
<code>PKNCAdata</code> object
<ul>
<li>the <code>PKNCAconc</code> object must be given; the
<code>PKNCAdose</code> object is optional; interval definitions are
usually given; calculation options may be given</li>
</ul>
</li>
<li>
<code><a href="../reference/pk.nca.html">pk.nca()</a></code>: calculate the NCA parameters from a data
object into a <code>PKNCAresult</code> object</li>
</ul>
</div>
<div class="section level3">
<h3 id="how-do-i-do-a-simple-calculation-all-steps">How do I do a simple calculation? all steps<a class="anchor" aria-label="anchor" href="#how-do-i-do-a-simple-calculation-all-steps"></a>
</h3>
<p>We will break this down in subsequent slides.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Concentration data setup</span></span>
<span><span class="va">d_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span></span>
<span><span class="co"># Dose data setup</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_dose</span><span class="op">)</span></span>
<span><span class="co"># Combine concentration and dose</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="co"># Calculate the results</span></span>
<span><span class="va">o_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="smaller" id="how-do-i-do-a-simple-calculation-concentration-data">How do I do a simple calculation? Concentration
data<a class="anchor" aria-label="anchor" href="#how-do-i-do-a-simple-calculation-concentration-data"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load your dataset as a data.frame</span></span>
<span><span class="va">d_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Take a look at the data</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d_conc</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:53%;" class="table">
<colgroup>
<col width="13%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Wt</th>
<th align="center">Dose</th>
<th align="center">Time</th>
<th align="center">conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">79.6</td>
<td align="center">4.02</td>
<td align="center">0</td>
<td align="center">0.74</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">79.6</td>
<td align="center">4.02</td>
<td align="center">0.25</td>
<td align="center">2.84</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the PKNCAconc object indicating the concentration and time columns, the</span></span>
<span><span class="co"># dataset, and any other options.</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="smaller" id="how-do-i-do-a-simple-calculation-dose-data">How do I do a simple calculation? Dose data<a class="anchor" aria-label="anchor" href="#how-do-i-do-a-simple-calculation-dose-data"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load your dataset as a data.frame</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co"># Take a look at the data</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="va">d_dose</span><span class="op">)</span></span></code></pre></div>
<table style="width:53%;" class="table">
<colgroup>
<col width="13%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="center">Subject</th>
<th align="center">Wt</th>
<th align="center">Dose</th>
<th align="center">Time</th>
<th align="center">conc</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">1</td>
<td align="center">79.6</td>
<td align="center">4.02</td>
<td align="center">0</td>
<td align="center">0.74</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the PKNCAdose object indicating the dose amount and time columns, the</span></span>
<span><span class="co"># dataset, and any other options.</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">~</span><span class="va">Time</span>, data<span class="op">=</span><span class="va">d_dose</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="smaller" id="how-do-i-do-a-simple-calculation-calculate-results">How do I do a simple calculation? Calculate
results<a class="anchor" aria-label="anchor" href="#how-do-i-do-a-simple-calculation-calculate-results"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine the PKNCAconc and PKNCAdose objects.  You can add interval</span></span>
<span><span class="co"># specifications and calculation options here.</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="co"># Calculate the results</span></span>
<span><span class="va">o_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="how-do-i-do-a-simple-calculation-get-results">How do I do a simple calculation? Get results<a class="anchor" aria-label="anchor" href="#how-do-i-do-a-simple-calculation-get-results"></a>
</h3>
<p>To calculate summary statistics, use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>; to
extract all individual-level results, use
<code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code>.</p>
<p>The <code>"caption"</code> attribute of the summary describes how the
summary statistics were calculated for each parameter. (Hint:
<code><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander::pander()</a></code> knows how to use that to put the caption
on a table in a report.)</p>
<p>The individual results contain the columns for start time, end time,
grouping variables (none in this example), parameter names, values, and
if the value should be excluded.</p>
</div>
<div class="section level3">
<h3 class="smaller" id="how-do-i-do-a-simple-calculation-get-summary-results">How do I do a simple calculation? Get summary
results<a class="anchor" aria-label="anchor" href="#how-do-i-do-a-simple-calculation-get-summary-results"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Look at summarized results</span></span>
<span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_result</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>auclast, cmax, aucinf.obs: geometric mean and geometric
coefficient of variation; tmax: median and range; half.life: arithmetic
mean and standard deviation</caption>
<colgroup>
<col width="9%">
<col width="6%">
<col width="4%">
<col width="13%">
<col width="13%">
<col width="22%">
<col width="13%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">N</th>
<th align="center">auclast</th>
<th align="center">cmax</th>
<th align="center">tmax</th>
<th align="center">half.life</th>
<th align="center">aucinf.obs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">24</td>
<td align="center">1</td>
<td align="center">92.4 [NC]</td>
<td align="center">.</td>
<td align="center">.</td>
<td align="center">.</td>
<td align="center">.</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">1</td>
<td align="center">.</td>
<td align="center">10.5 [NC]</td>
<td align="center">1.12 [1.12, 1.12]</td>
<td align="center">14.3 [NC]</td>
<td align="center">215 [NC]</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 class="smaller" id="how-do-i-do-a-simple-calculation-get-individual-results">How do I do a simple calculation? Get individual
results<a class="anchor" aria-label="anchor" href="#how-do-i-do-a-simple-calculation-get-individual-results"></a>
</h3>
<table style="width:62%;" class="table">
<colgroup>
<col width="11%">
<col width="8%">
<col width="15%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">PPTESTCD</th>
<th align="center">PPORRES</th>
<th align="center">exclude</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">24</td>
<td align="center">auclast</td>
<td align="center">92.37</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">cmax</td>
<td align="center">10.5</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">tmax</td>
<td align="center">1.12</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="pknca-datasets">PKNCA datasets<a class="anchor" aria-label="anchor" href="#pknca-datasets"></a>
</h2>
<div class="section level3">
<h3 id="how-does-pknca-think-about-data">How does PKNCA think about data?<a class="anchor" aria-label="anchor" href="#how-does-pknca-think-about-data"></a>
</h3>
<p>Three types of data are inputs for calculation in PKNCA:</p>
<ul>
<li>concentration-time (<code>PKNCAconc</code>),</li>
<li>dose-time (<code>PKNCAdose</code>), and</li>
<li>intervals.</li>
</ul>
<p><code>PKNCAconc</code> and <code>PKNCAdose</code> objects can
optionally have groups. The groups in a <code>PKNCAdose</code> object
must be the same or fewer than the groups in <code>PKNCAconc</code>
object (for example, all subjects in a treatment arm may receive the
same dose).</p>
</div>
<div class="section level3">
<h3 class="columns-2 smaller" id="what-is-an-interval-and-how-is-it-different-than-a-group">What is an “interval” and how is it
different than a “group”?<a class="anchor" aria-label="anchor" href="#what-is-an-interval-and-how-is-it-different-than-a-group"></a>
</h3>
<p>A <strong>group</strong> separates one full concentration-time
profile for a subject that you may ever want to consider at the same
time. Usually, it groups by study, treatment, analyte, and subject
(other groups can be useful depending on the study design).</p>
<p>An <strong>interval</strong> selects a time range within a
<strong>group</strong>.</p>
<p>One time can be in zero or more intervals, but only zero or one
group. Intervals can be adjacent (0-12 and 12-24) or overlap (0-12 and
0-24). In other words, one sample may be used in more than one interval,
but one sample will never be used in more than one group.</p>
<p><strong>Legend:</strong> The group contains all points on the figure.
Shaded regions indicate intervals. Arrows indicate points shared between
intervals within the group.</p>
<p class="forceBreak">
</p>
<p><img src="v30-training-session_files/figure-html/unnamed-chunk-17-1.png" width="384"></p>
</div>
<div class="section level3">
<h3 class="smaller" id="common-data-management-requirements-before-sending-data-to-pknca">Common data management requirements before sending
data to PKNCA<a class="anchor" aria-label="anchor" href="#common-data-management-requirements-before-sending-data-to-pknca"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Time must not be missing for <code>PKNCAconc</code> (if given to
<code>PKNCAdose</code>, it must not be missing).</li>
<li>Below the limit of quantification (BLQ) concentrations must be set
to zero (not <code>NA</code>).</li>
<li>Imputation of time zero is required for AUC calculation.</li>
<li>Especially for actual-time calculations, imputation of the beginning
of the interval is usually needed.</li>
</ol>
<p>Columns must be created for:</p>
<ul>
<li>Concentration or dose,</li>
<li>Time</li>
<li>Groups
<ul>
<li>usually columns for study, treatment arm, subject;</li>
<li>sometimes analyte, formulation, period (needed in case the same
subject receives the same treatment arm multiple times)</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 class="columns-2" id="setup-your-concentration-data">Setup your concentration data<a class="anchor" aria-label="anchor" href="#setup-your-concentration-data"></a>
</h3>
<ul>
<li>Concentration data must be numeric</li>
</ul>
<p class="forceBreak">
</p>
<div class="bigStrikethroughOuter">
<div class="bigStrikethroughInner">
A
</div>
</div>
</div>
<div class="section level3">
<h3 class="columns-2" id="setup-your-concentration-data-1">Setup your concentration data<a class="anchor" aria-label="anchor" href="#setup-your-concentration-data-1"></a>
</h3>
<ul>
<li>Concentration data must be numeric</li>
<li>Time must be numeric and not be missing</li>
</ul>
<p class="forceBreak">
</p>
<div class="bigStrikethroughOuter">
<div class="bigStrikethroughInner">
NA
</div>
</div>
</div>
<div class="section level3">
<h3 class="columns-2" id="setup-your-concentration-data-2">Setup your concentration data<a class="anchor" aria-label="anchor" href="#setup-your-concentration-data-2"></a>
</h3>
<ul>
<li>Concentration data must be numeric</li>
<li>Time must be numeric and not be missing</li>
<li>Groups can be anything, setup at the level of the individual</li>
</ul>
<p class="forceBreak">
</p>
<div class="autoImageWidth">
<p><img src="https://apps-afsc.fisheries.noaa.gov/Quarterly/amj2005/images/killerwhales.jpg"><br>
Group: <span style="color: green;">🗸</span> a pod of killer whales</p>
</div>
</div>
<div class="section level3">
<h3 class="smaller" id="setup-your-dosing-data-if-you-have-it-and-even-if-you-dont">Setup your dosing data (if you have it and even if
you don’t)<a class="anchor" aria-label="anchor" href="#setup-your-dosing-data-if-you-have-it-and-even-if-you-dont"></a>
</h3>
<p>Normal dosing data setup:
<code>PKNCAdose(dose~time|actarm+usubjid, data=d_dose)</code></p>
<ul>
<li>Dose amount must be numeric — or it can be omitted
<ul>
<li><code>PKNCAdose(~time|actarm+usubjid, data=d_dose)</code></li>
</ul>
</li>
<li>Time must be numeric and not be missing — or it can be omitted
<ul>
<li><code>PKNCAdose(dose~.|actarm+usubjid, data=d_dose)</code></li>
</ul>
</li>
<li>Groups can be anything — may be grouped at a higher level than the
individual
<ul>
<li>Useful when all dose amounts and times are the same within an arm:
<code>PKNCAdose(dose~time|actarm, data=d_dose)</code>
</li>
<li>Useful dose amount is the same at all times within an arm:
<code>PKNCAdose(dose~.|actarm, data=d_dose)</code>
</li>
<li>Useful when times are all the same within an arm but dose may
differ: <code>PKNCAdose(~time|actarm, data=d_dose)</code>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="define-your-intervals">Define your intervals<a class="anchor" aria-label="anchor" href="#define-your-intervals"></a>
</h3>
<p>Intervals have columns for:</p>
<ul>
<li>
<code>start</code> and <code>end</code> times for the interval,</li>
<li>groups matching any level of grouping; intervals apply by a
merge/join with the groups</li>
<li>parameters to calculate (<code>TRUE</code> means to calculate it;
<code>FALSE</code> means don’t). The full list of available parameters
is in the <a href="http://billdenney.github.io/pknca/articles/Selection-of-Calculation-Intervals.html#parameters-available-for-calculation-in-an-interval-1">selection
of calculation intervals vignette</a>.
<ul>
<li>You only have to specify the parameter you want, not all
parameters.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="define-your-intervals-example">Define your intervals: example<a class="anchor" aria-label="anchor" href="#define-your-intervals-example"></a>
</h3>
<ul>
<li>For time 0 to 24, calculate AUClast</li>
<li>For time 0 to infinity, calculate cmax, tmax, half.life, and
aucinf.obs</li>
</ul>
<table style="width:90%;" class="table">
<colgroup>
<col width="11%">
<col width="8%">
<col width="13%">
<col width="11%">
<col width="11%">
<col width="16%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">auclast</th>
<th align="center">cmax</th>
<th align="center">tmax</th>
<th align="center">half.life</th>
<th align="center">aucinf.obs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">24</td>
<td align="center">TRUE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
<td align="center">FALSE</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">FALSE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
<td align="center">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="calculations-above-the-hood">Calculations above the hood<a class="anchor" aria-label="anchor" href="#calculations-above-the-hood"></a>
</h2>
<div class="section level3">
<h3 id="prepare-your-data-for-calculation">Prepare your data for calculation<a class="anchor" aria-label="anchor" href="#prepare-your-data-for-calculation"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Treatment<span class="op">=</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">Dose</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">)</span><span class="op">~</span><span class="st">"Low dose"</span>,</span>
<span>        <span class="cn">TRUE</span><span class="op">~</span><span class="st">"High dose"</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># The study was single-dose</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">d_conc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Treatment</span>, <span class="va">Subject</span>, <span class="va">Dose</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dose_time<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="build" id="calculate-without-dosing-data">Calculate without dosing data<a class="anchor" aria-label="anchor" href="#calculate-without-dosing-data"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Treatment</span><span class="op">+</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in PKNCAdata.default(data.conc = data.conc, data.dose = data.dose,  : </span></span>
<span><span class="co">##   If data.dose is not given, intervals must be given</span></span></code></pre>
<p>Whoops! Without dosing, we need intervals.</p>
</div>
<div class="section level3">
<h3 id="calculate-without-dosing-data-try-2">Calculate without dosing data, try 2<a class="anchor" aria-label="anchor" href="#calculate-without-dosing-data-try-2"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Treatment</span><span class="op">+</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span></span>
<span><span class="va">d_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="cn">Inf</span>, cmax<span class="op">=</span><span class="cn">TRUE</span>, tmax<span class="op">=</span><span class="cn">TRUE</span>, half.life<span class="op">=</span><span class="cn">TRUE</span>, aucinf.obs<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">o_data_manual_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, intervals<span class="op">=</span><span class="va">d_intervals</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data_manual_intervals</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## No dose information provided, calculations requiring dose will return NA.</span></span></code></pre>
<pre><code><span><span class="co">##  start end Treatment N        cmax               tmax   half.life aucinf.obs</span></span>
<span><span class="co">##      0 Inf High dose 5 9.16 [19.4] 3.48 [0.980, 3.55] 7.73 [1.08] 120 [26.2]</span></span>
<span><span class="co">##      0 Inf  Low dose 7 8.30 [15.2] 1.12 [0.630, 2.02] 8.50 [2.67] 111 [31.6]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: cmax, aucinf.obs: geometric mean and geometric coefficient of variation; tmax: median and range; half.life: arithmetic mean and standard deviation</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="dosing-data-helps-with-interval-setup">Dosing data helps with interval setup<a class="anchor" aria-label="anchor" href="#dosing-data-helps-with-interval-setup"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Treatment</span><span class="op">+</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">Dose</span><span class="op">~</span><span class="va">dose_time</span><span class="op">|</span><span class="va">Treatment</span><span class="op">+</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_dose</span><span class="op">)</span></span>
<span><span class="va">o_data_auto_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="va">o_data_auto_intervals</span><span class="op">$</span><span class="va">intervals</span><span class="op">$</span><span class="va">aucint.inf.obs</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data_auto_intervals</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  start end Treatment N     auclast        cmax               tmax   half.life</span></span>
<span><span class="co">##      0  24  Low dose 7 70.2 [14.4]           .                  .           .</span></span>
<span><span class="co">##      0 Inf  Low dose 7           . 8.30 [15.2] 1.12 [0.630, 2.02] 8.50 [2.67]</span></span>
<span><span class="co">##      0  24 High dose 5 81.3 [34.2]           .                  .           .</span></span>
<span><span class="co">##      0 Inf High dose 5           . 9.16 [19.4] 3.48 [0.980, 3.55] 7.73 [1.08]</span></span>
<span><span class="co">##  aucinf.obs aucint.inf.obs</span></span>
<span><span class="co">##           .    94.1 [22.5]</span></span>
<span><span class="co">##  111 [31.6]     111 [31.6]</span></span>
<span><span class="co">##           .     105 [23.3]</span></span>
<span><span class="co">##  120 [26.2]     120 [26.2]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: auclast, cmax, aucinf.obs, aucint.inf.obs: geometric mean and geometric coefficient of variation; tmax: median and range; half.life: arithmetic mean and standard deviation</span></span></code></pre>
</div>
<div class="section level3">
<h3 class="columns-2" id="auc-considerations-with-pknca-13">AUC considerations with PKNCA (1/3)<a class="anchor" aria-label="anchor" href="#auc-considerations-with-pknca-13"></a>
</h3>
<p><img src="v30-training-session_files/figure-html/unnamed-chunk-23-1.png" width="100%"></p>
<p class="forceBreak">
</p>
<p>The considerations below mainly apply to actual-time data;
nominal-time data usually have measurements at the start and end time
for the interval.</p>
<p>With an interval start and end of 0 and 24 (and the last measurement
time just after 24 hours):</p>
<ul>
<li>
<strong>AUC<sub>last</sub></strong> is calculated only based on
points within the interval (the AUClast color in the figure)</li>
</ul>
</div>
<div class="section level3">
<h3 class="columns-2" id="auc-considerations-with-pknca-23">AUC considerations with PKNCA (2/3)<a class="anchor" aria-label="anchor" href="#auc-considerations-with-pknca-23"></a>
</h3>
<p><img src="v30-training-session_files/figure-html/unnamed-chunk-24-1.png" width="100%"></p>
<p class="forceBreak">
</p>
<p>The considerations below mainly apply to actual-time data;
nominal-time data usually have measurements at the start and end time
for the interval.</p>
<p>With an interval start and end of 0 and 24 (and the last measurement
time just after 24 hours):</p>
<ul>
<li>
<strong>AUC<sub>int</sub></strong> looks at the points in the
interval, and if there is no measurement at the interval end time,
interpolates or extrapolates to the interval end time (the AUClast and
AUCint color in the figure)</li>
</ul>
</div>
<div class="section level3">
<h3 class="columns-2" id="auc-considerations-with-pknca-23-1">AUC considerations with PKNCA (2/3)<a class="anchor" aria-label="anchor" href="#auc-considerations-with-pknca-23-1"></a>
</h3>
<p><img src="v30-training-session_files/figure-html/unnamed-chunk-25-1.png" width="100%"></p>
<p class="forceBreak">
</p>
<p>The considerations below mainly apply to actual-time data;
nominal-time data usually have measurements at the start and end time
for the interval.</p>
<p>With an interval start and end of 0 and 24 (and the last measurement
time just after 24 hours):</p>
<ul>
<li>
<strong>AUC<sub>∞</sub></strong> is calculated based on
AUC<sub>last</sub>, t<sub>last</sub>, and the half-life from
t<sub>last</sub>, only using data within the interval– no data after the
end of the interval.</li>
<li>Ensure that the interval used for calculating AUC<sub>∞</sub>
includes all the points desired (usually, <code>end=Inf</code>).</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="hands-on-workshop">Hands-on workshop<a class="anchor" aria-label="anchor" href="#hands-on-workshop"></a>
</h2>
<div class="section level3">
<h3 id="steady-state-intramuscular-administration">Steady-state intramuscular administration<a class="anchor" aria-label="anchor" href="#steady-state-intramuscular-administration"></a>
</h3>
<p>The data for the exercise are from a PK study of amikacin in a killer
whale and a beluga whale. (DOI: 10.1638/03-078)</p>
<p><img src="https://apps-afsc.fisheries.noaa.gov/Quarterly/amj2005/images/killerwhales.jpg"></p>
<p>(Callback…)</p>
</div>
<div class="section level3">
<h3 id="steady-state-intramuscular-administration-1">Steady-state intramuscular administration<a class="anchor" aria-label="anchor" href="#steady-state-intramuscular-administration-1"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/" class="external-link">PKNCA</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"c:/tmp/whale_conc.csv"</span><span class="op">)</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"c:/tmp/whale_dose.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d_conc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d_dose</span><span class="op">)</span></span>
<span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">concentration</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Animal</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">dose</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Animal</span>, data<span class="op">=</span><span class="va">d_dose</span><span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="va">o_data</span><span class="op">$</span><span class="va">intervals</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span>, drop.group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="day-2-start">Day 2 Start<a class="anchor" aria-label="anchor" href="#day-2-start"></a>
</h2>
</div>
<div class="section level2">
<h2 id="control-your-data">Control your data<a class="anchor" aria-label="anchor" href="#control-your-data"></a>
</h2>
<div class="section level3">
<h3 id="including-and-excluding-data-points">Including and excluding data points<a class="anchor" aria-label="anchor" href="#including-and-excluding-data-points"></a>
</h3>
<p>Data may be included/excluded in two ways:</p>
<ul>
<li>Overall: excluded a row of data from all analyses</li>
<li>Half-life: excluded from half-life calculations, but included in all
other analyses</li>
</ul>
<p>For both ways of including/excluding data, it is defined by a column
in the input data. The column is either <code>NA</code> or an empty
string (<code>""</code>) to indicate “no” or any other text to indicate
“yes”.</p>
</div>
<div class="section level3">
<h3 class="columns-2" id="exclude-data-points-overall">Exclude data points overall<a class="anchor" aria-label="anchor" href="#exclude-data-points-overall"></a>
</h3>
<p>Use the <code>exclude</code> argument for <code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code> or
<code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>.</p>
<p>When you use <code>exclude</code>, this is how you give your data to
PKNCA:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_before_exclude</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    time<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>    conc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>    not_this<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"Not this"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span></span>
<span>    data<span class="op">=</span><span class="va">d_before_exclude</span>,</span>
<span>    <span class="va">conc</span><span class="op">~</span><span class="va">time</span>,</span>
<span>    exclude<span class="op">=</span><span class="st">"not_this"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p class="forceBreak">
</p>
<p>And, this is how PKNCA thinks about it:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span></span>
<span>  <span class="va">d_before_exclude</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">not_this</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table style="width:35%;" class="table">
<colgroup>
<col width="9%">
<col width="9%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="center">time</th>
<th align="center">conc</th>
<th align="center">not_this</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">0.5</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">0.25</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="exclude-data-points-overall-1">Exclude data points overall<a class="anchor" aria-label="anchor" href="#exclude-data-points-overall-1"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">d_before_exclude</span>, <span class="va">conc</span><span class="op">~</span><span class="va">time</span>, exclude<span class="op">=</span><span class="st">"not_this"</span><span class="op">)</span></span></code></pre></div>
<div class="imessage">
<div class="yours messages">
<div class="message last">
Hey babe, did you get my 5 rows of data?
</div>
</div>
<div class="mine messages">
<div class="message last">
I only saw 4 rows. Are you sure you sent 5?
</div>
</div>
<div class="yours messages">
<div class="message last">
Yep, definitely 5 check that last slide. 😠
</div>
</div>
<div class="mine messages">
<div class="message">
…
</div>
<div class="message last">
New phone. Who dis?
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 class="smaller" id="digression-how-is-λz-automatically-calculated">Digression: How is λz automatically calculated?<a class="anchor" aria-label="anchor" href="#digression-how-is-%CE%BBz-automatically-calculated"></a>
</h3>
<ul>
<li>Filter the data from the first point after t<sub>max</sub> (or from
t<sub>max</sub> if <code>allow.tmax.in.half.life=TRUE</code>) to
t<sub>last</sub> and excluding BLQ in the middle.</li>
<li>Fit the semi-log line from 3 points before t<sub>last</sub> (3 can
be changed with the <code>min.hl.points</code> option) to
t<sub>last</sub>.
<ul>
<li>Repeat for all sets of points from there to the first point
included.</li>
<li>If that 3 points are not available, it is not calculated.</li>
</ul>
</li>
<li>Among the fits, select the best adjusted r<sup>2</sup> (within a
tolerance of <code>adj.r.squared.factor</code>).</li>
<li>Require λz<code>&gt; 0</code>.</li>
<li>If more than one fit is available at this point, select the one with
the most points included.</li>
</ul>
<p>Note: WinNonlin first requires λz<code>&gt; 0</code> then selects for
adjusted r<sup>2</sup>. Therefore, WinNonlin will occasionally provide a
half-life when PKNCA will not, but the fit line is not as good (as
measured by r<sup>2</sup>). The selection of filtering order is an
intentional feature with PKNCA, and it generally has minimal impact on
summary statistics because the quality of the half-life fit is usually
low in this scenario.</p>
</div>
<div class="section level3">
<h3 id="λz-control-manual-exclusions-and-inclusions-of-data-points">λz control (manual exclusions and inclusions of data points)<a class="anchor" aria-label="anchor" href="#%CE%BBz-control-manual-exclusions-and-inclusions-of-data-points"></a>
</h3>
<p>Use the <code>exclude_half.life</code> or
<code>include_half.life</code> argument for <code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code>.
The two arguments behave very differently in how points are selected for
half-life.</p>
<p><code>exclude_half.life</code> uses the same automatic point
selection method of curve stripping (described before), but it excludes
individual points from that calculation.</p>
<p><code>include_half.life</code> uses no automatic point selection
method, and only points specifically noted by the analyst are
included.</p>
</div>
</div>
<div class="section level2">
<h2 id="less-common-calculations">Less-common calculations<a class="anchor" aria-label="anchor" href="#less-common-calculations"></a>
</h2>
<div class="section level3">
<h3 id="urine-calculations">Urine calculations<a class="anchor" aria-label="anchor" href="#urine-calculations"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_urine</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    conc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    urine_volume<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">100</span>, <span class="fl">300</span><span class="op">)</span>,</span>
<span>    time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">d_urine</span>, <span class="va">conc</span><span class="op">~</span><span class="va">time</span>, volume<span class="op">=</span><span class="st">"urine_volume"</span><span class="op">)</span></span>
<span><span class="va">d_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fl">24</span>, ae<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, intervals<span class="op">=</span><span class="va">d_intervals</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  start end N        ae</span></span>
<span><span class="co">##      0  24 1 1300 [NC]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: ae: geometric mean and geometric coefficient of variation</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="urine-calculations-understanding-what-is-happening-and-potential-hiccups">Urine calculations: understanding what is happening and potential
hiccups<a class="anchor" aria-label="anchor" href="#urine-calculations-understanding-what-is-happening-and-potential-hiccups"></a>
</h3>
<p>Intervals for urine are treated the same as any other interval type.
Specifically, PKNCA does not look outside the start and end of the
interval.</p>
<ul>
<li>Watch out for e.g. a 24-hour urine amount to be included in more
than one interval because start = 0 and end = 24.</li>
<li>Watch out for an actual start or end time to be outside of the
interval and therefore to be omitted from calculations.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="calculations-below-the-hood">Calculations below the hood<a class="anchor" aria-label="anchor" href="#calculations-below-the-hood"></a>
</h2>
<div class="section level3">
<h3 id="pknca-only-calculates-what-is-required-not-every-possible-parameter-1-of-2">PKNCA only calculates what is required, not every possible parameter
(1 of 2)<a class="anchor" aria-label="anchor" href="#pknca-only-calculates-what-is-required-not-every-possible-parameter-1-of-2"></a>
</h3>
<p>If you don’t need a parameter, PKNCA won’t calculate it.</p>
<p>For example, if all you need is <code>cmax</code>, all you’ll get is
<code>cmax</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>conc<span class="op">=</span><span class="fl">2</span><span class="op">^</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, time<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, <span class="va">conc</span><span class="op">~</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, intervals<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="cn">Inf</span>, cmax<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   start   end PPTESTCD PPORRES exclude</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     0   <span style="color: #BB0000;">Inf</span> cmax         0.5 <span style="color: #BB0000;">NA</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 class="columns-2 smaller" id="pknca-only-calculates-what-is-required-not-every-possible-parameter-2-of-2">PKNCA only calculates what is required,
not every possible parameter (2 of 2)<a class="anchor" aria-label="anchor" href="#pknca-only-calculates-what-is-required-not-every-possible-parameter-2-of-2"></a>
</h3>
<p>If you need AUC<sub>0-</sub>, PKNCA will calculate other required
parameters behind the scenes.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span></span>
<span>    <span class="va">o_conc</span>,</span>
<span>    intervals<span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="cn">Inf</span>,</span>
<span>        aucinf.obs<span class="op">=</span><span class="cn">TRUE</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p class="forceBreak">
</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 12 × 5</span></span></span>
<span><span class="co">##    start   end PPTESTCD            PPORRES exclude</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     0   <span style="color: #BB0000;">Inf</span> tmax                 0      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     0   <span style="color: #BB0000;">Inf</span> tlast                3      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     0   <span style="color: #BB0000;">Inf</span> clast.obs            0.062<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z             0.693  <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     0   <span style="color: #BB0000;">Inf</span> r.squared            1      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     0   <span style="color: #BB0000;">Inf</span> adj.r.squared        1      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z.time.first  1      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z.n.points    3      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     0   <span style="color: #BB0000;">Inf</span> clast.pred           0.062<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>     0   <span style="color: #BB0000;">Inf</span> half.life            1      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>     0   <span style="color: #BB0000;">Inf</span> span.ratio           2      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>     0   <span style="color: #BB0000;">Inf</span> aucinf.obs           0.721  <span style="color: #BB0000;">NA</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="how-to-select-the-correct-parameters-for-calculations-aka-why-are-there-32-types-of-auc-in-pknca">How to select the correct parameters for calculations (aka, why are
there 32 types of AUC in PKNCA?)<a class="anchor" aria-label="anchor" href="#how-to-select-the-correct-parameters-for-calculations-aka-why-are-there-32-types-of-auc-in-pknca"></a>
</h3>
<p>CDISC has one set of names, but they are not precise (e.g. AUCINT
doesn’t tell the interpolation/extrapolation method).</p>
<p>PKNCA tries to be everything to everyone (in terms of parameters
calculated), and it simultaneously tries to be precise. That yields many
parameters.</p>
<p>See the Selection of Calculation Intervals vignette in the <a href="http://billdenney.github.io/pknca/articles/Selection-of-Calculation-Intervals.html#parameters-available-for-calculation-in-an-interval-1">Parameters
Available for Calculation in an Interval section</a> for all available
parameters.</p>
</div>
<div class="section level3">
<h3 class="smaller" id="when-are-intervals-partly-ignored">When are intervals (partly) ignored?<a class="anchor" aria-label="anchor" href="#when-are-intervals-partly-ignored"></a>
</h3>
<p>Very few parameters reach outside of the <code>start</code> and
<code>end</code> of an interval for additional information about what is
being calculated. As of the writing of these training materials (PKNCA
version 0.9.5), the only parameters that look outside are the
<code>aucint</code> class of parameters.</p>
<p>AUC<sub>int</sub> may look after the end of the interval to calculate
the concentration at <code>end</code>.</p>
<p>Note: Watch out for a dose before the next concentration (e.g. a dose
at 24 hours but the prior sample is around 12 and the next is around
25):</p>
<p><img src="v30-training-session_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="control-your-results">Control your results<a class="anchor" aria-label="anchor" href="#control-your-results"></a>
</h2>
<div class="section level3">
<h3 class="smaller" id="excluding-results-not-the-best-way">Excluding results (Not the best way)<a class="anchor" aria-label="anchor" href="#excluding-results-not-the-best-way"></a>
</h3>
<p>A simple way to exclude a value from results is to convert the
results to a data.frame and then drop the rows you don’t want:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">PPTESTCD</span> <span class="op">!=</span> <span class="st">"half.life"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 11 × 5</span></span></span>
<span><span class="co">##    start   end PPTESTCD            PPORRES exclude</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     0   <span style="color: #BB0000;">Inf</span> tmax                 0      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     0   <span style="color: #BB0000;">Inf</span> tlast                3      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     0   <span style="color: #BB0000;">Inf</span> clast.obs            0.062<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z             0.693  <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     0   <span style="color: #BB0000;">Inf</span> r.squared            1      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     0   <span style="color: #BB0000;">Inf</span> adj.r.squared        1      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z.time.first  1      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z.n.points    3      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     0   <span style="color: #BB0000;">Inf</span> clast.pred           0.062<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>     0   <span style="color: #BB0000;">Inf</span> span.ratio           2      <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>     0   <span style="color: #BB0000;">Inf</span> aucinf.obs           0.721  <span style="color: #BB0000;">NA</span></span></span></code></pre>
<p>But, parameters derived from half-life remain.</p>
</div>
<div class="section level3">
<h3 class="columns-2 smaller" id="excluding-results-the-best-way-12">Excluding results (The best way, 1/2)<a class="anchor" aria-label="anchor" href="#excluding-results-the-best-way-12"></a>
</h3>
<p>When you use the <code><a href="../reference/exclude.html">exclude()</a></code> function, parameters that are
dependent on an excluded parameter will be excluded.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_nca_excluded</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">o_nca</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/exclude.html">exclude</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="fu"><a href="../reference/exclude_nca.html">exclude_nca_span.ratio</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">o_nca_excluded</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 12 × 5</span></span></span>
<span><span class="co">##    start   end PPTESTCD            PPORRES exclude       </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>     0   <span style="color: #BB0000;">Inf</span> tmax                 0      <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>     0   <span style="color: #BB0000;">Inf</span> tlast                3      <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>     0   <span style="color: #BB0000;">Inf</span> clast.obs            0.062<span style="text-decoration: underline;">5</span> <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z             0.693  Span ratio &lt; 3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>     0   <span style="color: #BB0000;">Inf</span> r.squared            1      Span ratio &lt; 3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>     0   <span style="color: #BB0000;">Inf</span> adj.r.squared        1      Span ratio &lt; 3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z.time.first  1      Span ratio &lt; 3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>     0   <span style="color: #BB0000;">Inf</span> lambda.z.n.points    3      Span ratio &lt; 3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>     0   <span style="color: #BB0000;">Inf</span> clast.pred           0.062<span style="text-decoration: underline;">5</span> Span ratio &lt; 3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>     0   <span style="color: #BB0000;">Inf</span> half.life            1      Span ratio &lt; 3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>     0   <span style="color: #BB0000;">Inf</span> span.ratio           2      Span ratio &lt; 3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>     0   <span style="color: #BB0000;">Inf</span> aucinf.obs           0.721  Span ratio &lt; 3</span></span></code></pre>
</div>
<div class="section level3">
<h3 class="smaller" id="excluding-results-the-best-way-22">Excluding results (The best way, 2/2)<a class="anchor" aria-label="anchor" href="#excluding-results-the-best-way-22"></a>
</h3>
<p>Now, everything dependent on the half-life is excluded in
summaries.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  start end N aucinf.obs</span></span>
<span><span class="co">##      0 Inf 1 0.721 [NC]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: aucinf.obs: geometric mean and geometric coefficient of variation</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca_excluded</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  start end N aucinf.obs</span></span>
<span><span class="co">##      0 Inf 1         NC</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: aucinf.obs: geometric mean and geometric coefficient of variation</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="nca-related-calculations">NCA-related calculations<a class="anchor" aria-label="anchor" href="#nca-related-calculations"></a>
</h2>
<div class="section level3">
<h3 class="smaller columns-2" id="superposition">Superposition<a class="anchor" aria-label="anchor" href="#superposition"></a>
</h3>
<p>Superposition assumes linear kinetics and can convert a single-dose
profile to multi-dose.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subject 2 is selected for a BLQ time=0 concentration</span></span>
<span><span class="va">d_prep</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Superposition to steady-state is the default</span></span>
<span><span class="va">d_ss</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span></span>
<span>    conc<span class="op">=</span><span class="va">d_prep</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time<span class="op">=</span><span class="va">d_prep</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    tau<span class="op">=</span><span class="fl">24</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># Going to steady-state is also an option</span></span>
<span><span class="co"># (n.tau=2 means the second dose)</span></span>
<span><span class="va">d_second_dose</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span></span>
<span>    conc<span class="op">=</span><span class="va">d_prep</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time<span class="op">=</span><span class="va">d_prep</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    tau<span class="op">=</span><span class="fl">24</span>,</span>
<span>    n.tau<span class="op">=</span><span class="fl">2</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p class="forceBreak">
</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Want the profile for the first two doses</span></span>
<span><span class="co"># together?</span></span>
<span><span class="va">d_first_two</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span></span>
<span>    conc<span class="op">=</span><span class="va">d_prep</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time<span class="op">=</span><span class="va">d_prep</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    tau<span class="op">=</span><span class="fl">48</span>, <span class="co"># 48 hours</span></span>
<span>    n.tau<span class="op">=</span><span class="fl">1</span>, <span class="co"># One tau interval (0 to 48 hours)</span></span>
<span>    dose.times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="v30-training-session_files/figure-html/unnamed-chunk-36-1.png" width="288"></p>
</div>
<div class="section level3">
<h3 class="smaller" id="time-to-steady-state-calculations">Time-to-Steady-state calculations<a class="anchor" aria-label="anchor" href="#time-to-steady-state-calculations"></a>
</h3>
<p>Time-to-steady-state (tss) can be useful as a method to confirm that
a subject is at steady-state. PKNCA can calculate tss using trough
concentrations either with a monoexponential increase toward
steady-state (preferred) or a linear trend back from the final
point.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dose_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">96</span><span class="op">-</span><span class="fl">1</span>, by<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">d_multidose</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span></span>
<span>    conc<span class="op">=</span><span class="va">d_prep</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time<span class="op">=</span><span class="va">d_prep</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>    tau<span class="op">=</span><span class="fl">96</span>, <span class="co"># 48 hours</span></span>
<span>    n.tau<span class="op">=</span><span class="fl">1</span>, <span class="co"># One tau interval (0 to 48 hours)</span></span>
<span>    dose.times<span class="op">=</span><span class="va">dose_times</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="../reference/pk.tss.monoexponential.html">pk.tss.monoexponential</a></span><span class="op">(</span></span>
<span>  conc<span class="op">=</span><span class="va">d_multidose</span><span class="op">$</span><span class="va">conc</span>, time<span class="op">=</span><span class="va">d_multidose</span><span class="op">$</span><span class="va">time</span>, subject<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">d_multidose</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  time.dosing<span class="op">=</span><span class="va">dose_times</span>, subject.dosing<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dose_times</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  output<span class="op">=</span><span class="st">"single"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   tss.monoexponential.single</span></span>
<span><span class="co">## 1                   22.53005</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="reporting">Reporting<a class="anchor" aria-label="anchor" href="#reporting"></a>
</h2>
<div class="section level3">
<h3 id="graphics-are-intentionally-not-part-of-pknca-but-there-are-some-tricks-that-can-help">Graphics are intentionally not part of PKNCA, but there are some
tricks that can help…<a class="anchor" aria-label="anchor" href="#graphics-are-intentionally-not-part-of-pknca-but-there-are-some-tricks-that-can-help"></a>
</h3>
<p>Generate all individual profiles using the groups that you
defined:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span>, data<span class="op">=</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">d_plot</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/grouped_df.html" class="external-link">grouped_df</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span>, vars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/getGroups.html" class="external-link">getGroups</a></span><span class="op">(</span><span class="va">o_conc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    figure<span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span></span>
<span>          .l<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">data</span><span class="op">)</span>,</span>
<span>          .f<span class="op">=</span><span class="va">ggplot</span>,</span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Time</span>, y<span class="op">=</span><span class="va">conc</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        FUN<span class="op">=</span><span class="st">"+"</span>,</span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># d_plot$figure</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="best-practices-for-data---pknca---knitr">Best practices for Data -&gt; PKNCA -&gt; knitr<a class="anchor" aria-label="anchor" href="#best-practices-for-data---pknca---knitr"></a>
</h3>
<p>Make summary tables using the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function on the
NCA results, and use <code><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander::pander()</a></code> to make a pretty
table with captions.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:43%;" class="table">
<caption>aucinf.obs: geometric mean and geometric coefficient of
variation</caption>
<colgroup>
<col width="11%">
<col width="8%">
<col width="5%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="center">start</th>
<th align="center">end</th>
<th align="center">N</th>
<th align="center">aucinf.obs</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">0</td>
<td align="center">Inf</td>
<td align="center">1</td>
<td align="center">0.721 [NC]</td>
</tr></tbody>
</table>
<p>Make an NCA data listing using the <code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code>
function on the NCA results.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html" class="external-link">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<div class="section level3">
<h3 id="units-especially-clearance">Units (especially clearance)<a class="anchor" aria-label="anchor" href="#units-especially-clearance"></a>
</h3>
<p>PKNCA does not (yet) support units. The most common place where that
becomes an issue is with clearance which ends up having unusual units
like “mg/(hr*ng/mL)” (with units of mg for dosing, hr for time, and
ng/mL for concentration).</p>
</div>
<div class="section level3">
<h3 id="data-imputation">Data imputation<a class="anchor" aria-label="anchor" href="#data-imputation"></a>
</h3>
<p>Some data points are required for inputs such as:</p>
<ul>
<li>the start of the interval for AUC,</li>
<li>the end of the interval for some calculations
(e.g. AUC<sub>last</sub> vs AUC<sub>int</sub>), and</li>
<li>interpolated concentrations at the end of a urine interval for
urinary PK calculations.</li>
</ul>
</div>
<div class="section level3">
<h3 id="iv-bolus-auc-need-to-add-c0">IV bolus AUC (need to add C0)<a class="anchor" aria-label="anchor" href="#iv-bolus-auc-need-to-add-c0"></a>
</h3>
<p>PKNCA does not have an IV-aware AUC calculation (yet). So, C0 must be
separately imputed.</p>
</div>
<div class="section level3">
<h3 id="combined-multi-subject-data-e-g--sparse-animal-sampling">Combined, multi-subject data (e.g. sparse animal sampling)<a class="anchor" aria-label="anchor" href="#combined-multi-subject-data-e-g--sparse-animal-sampling"></a>
</h3>
<p>Averaging the concentration at a time point will allow for the mean
sparse sampling result. But general sparse sampling methods are not
(yet) implemented.</p>
</div>
<div class="section level3">
<h3 id="secondary-parameters-e-g--bioavailability-and-renal-clearance">Secondary parameters (e.g. bioavailability and renal clearance)<a class="anchor" aria-label="anchor" href="#secondary-parameters-e-g--bioavailability-and-renal-clearance"></a>
</h3>
<p>PKNCA does not (yet) have the ability to calculate secondary PK
parameters that require looking at more than one group/interval at a
time. (If you have good ideas for how to define the intervals for that,
please let me know.)</p>
</div>
</div>
<div class="section level2">
<h2 id="hands-on">Hands-on<a class="anchor" aria-label="anchor" href="#hands-on"></a>
</h2>
<div class="section level3">
<h3 class="smaller" id="single--and-multiple-dose-single-analyte-setup-the-underlying-datasets">Single- and Multiple-dose, single analyte: Setup the
underlying datasets<a class="anchor" aria-label="anchor" href="#single--and-multiple-dose-single-analyte-setup-the-underlying-datasets"></a>
</h3>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">Time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Subject<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">d_multidose</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">conc</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">d_conc</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span>tau<span class="op">=</span><span class="fl">24</span>, check.blq<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">d_singledose_single_analyte</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">d_conc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Study_Part<span class="op">=</span><span class="st">"Single"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">d_multidose_single_analyte</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">d_conc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Day<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>    <span class="va">d_multidose</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">time</span> <span class="op">+</span> <span class="fl">120</span>, Day<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Study_Part<span class="op">=</span><span class="st">"Multiple"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="smaller" id="single--and-multiple-dose-single-analyte-setup-the-concentration-and-dose-datasets">Single- and Multiple-dose, single analyte: Setup the
concentration and dose datasets<a class="anchor" aria-label="anchor" href="#single--and-multiple-dose-single-analyte-setup-the-concentration-and-dose-datasets"></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_single_multi_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">d_singledose_single_analyte</span>, <span class="va">d_multidose_single_analyte</span><span class="op">)</span></span>
<span><span class="va">d_single_multi_dose</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">d_single_multi_conc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="op">(</span><span class="va">Study_Part</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Single"</span> <span class="op">&amp;</span> <span class="va">time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|</span></span>
<span>      <span class="op">(</span><span class="va">Study_Part</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Multiple"</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">24</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="smaller" id="single--and-multiple-dose-single-analyte-perform-basic-analysis">Single- and Multiple-dose, single analyte: Perform
basic analysis<a class="anchor" aria-label="anchor" href="#single--and-multiple-dose-single-analyte-perform-basic-analysis"></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">d_single_multi_conc</span>, <span class="va">conc</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Study_Part</span><span class="op">+</span><span class="va">Subject</span><span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">d_single_multi_dose</span>, <span class="va">Dose</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Study_Part</span><span class="op">+</span><span class="va">Subject</span><span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="va">o_data</span><span class="op">$</span><span class="va">intervals</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Subject</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   start end auclast aucall aumclast aumcall aucint.last aucint.last.dose</span></span>
<span><span class="co">## 1     0  24    TRUE  FALSE    FALSE   FALSE       FALSE            FALSE</span></span>
<span><span class="co">## 2     0 Inf   FALSE  FALSE    FALSE   FALSE       FALSE            FALSE</span></span>
<span><span class="co">## 3     0 120    TRUE  FALSE    FALSE   FALSE       FALSE            FALSE</span></span>
<span><span class="co">## 4   120 144    TRUE  FALSE    FALSE   FALSE       FALSE            FALSE</span></span>
<span><span class="co">##   aucint.all aucint.all.dose    c0  cmax  cmin  tmax tlast tfirst clast.obs</span></span>
<span><span class="co">## 1      FALSE           FALSE FALSE FALSE FALSE FALSE FALSE  FALSE     FALSE</span></span>
<span><span class="co">## 2      FALSE           FALSE FALSE  TRUE FALSE  TRUE FALSE  FALSE     FALSE</span></span>
<span><span class="co">## 3      FALSE           FALSE FALSE  TRUE FALSE  TRUE FALSE  FALSE     FALSE</span></span>
<span><span class="co">## 4      FALSE           FALSE FALSE  TRUE FALSE  TRUE FALSE  FALSE     FALSE</span></span>
<span><span class="co">##   cl.last cl.all     f mrt.last mrt.iv.last vss.last vss.iv.last   cav ctrough</span></span>
<span><span class="co">## 1   FALSE  FALSE FALSE    FALSE       FALSE    FALSE       FALSE FALSE   FALSE</span></span>
<span><span class="co">## 2   FALSE  FALSE FALSE    FALSE       FALSE    FALSE       FALSE FALSE   FALSE</span></span>
<span><span class="co">## 3   FALSE  FALSE FALSE    FALSE       FALSE    FALSE       FALSE FALSE   FALSE</span></span>
<span><span class="co">## 4   FALSE  FALSE FALSE    FALSE       FALSE    FALSE       FALSE FALSE   FALSE</span></span>
<span><span class="co">##   cstart   ptr  tlag deg.fluc swing  ceoi aucabove.predose.all</span></span>
<span><span class="co">## 1  FALSE FALSE FALSE    FALSE FALSE FALSE                FALSE</span></span>
<span><span class="co">## 2  FALSE FALSE FALSE    FALSE FALSE FALSE                FALSE</span></span>
<span><span class="co">## 3  FALSE FALSE FALSE    FALSE FALSE FALSE                FALSE</span></span>
<span><span class="co">## 4  FALSE FALSE FALSE    FALSE FALSE FALSE                FALSE</span></span>
<span><span class="co">##   aucabove.trough.all    ae clr.last clr.obs clr.pred    fe sparse_auclast</span></span>
<span><span class="co">## 1               FALSE FALSE    FALSE   FALSE    FALSE FALSE          FALSE</span></span>
<span><span class="co">## 2               FALSE FALSE    FALSE   FALSE    FALSE FALSE          FALSE</span></span>
<span><span class="co">## 3               FALSE FALSE    FALSE   FALSE    FALSE FALSE          FALSE</span></span>
<span><span class="co">## 4               FALSE FALSE    FALSE   FALSE    FALSE FALSE          FALSE</span></span>
<span><span class="co">##   time_above aucivlast aucivall aucivint.last aucivint.all aucivpbextlast</span></span>
<span><span class="co">## 1      FALSE     FALSE    FALSE         FALSE        FALSE          FALSE</span></span>
<span><span class="co">## 2      FALSE     FALSE    FALSE         FALSE        FALSE          FALSE</span></span>
<span><span class="co">## 3      FALSE     FALSE    FALSE         FALSE        FALSE          FALSE</span></span>
<span><span class="co">## 4      FALSE     FALSE    FALSE         FALSE        FALSE          FALSE</span></span>
<span><span class="co">##   aucivpbextall aucivpbextint.last aucivpbextint.all half.life r.squared</span></span>
<span><span class="co">## 1         FALSE              FALSE             FALSE     FALSE     FALSE</span></span>
<span><span class="co">## 2         FALSE              FALSE             FALSE      TRUE     FALSE</span></span>
<span><span class="co">## 3         FALSE              FALSE             FALSE     FALSE     FALSE</span></span>
<span><span class="co">## 4         FALSE              FALSE             FALSE     FALSE     FALSE</span></span>
<span><span class="co">##   adj.r.squared lambda.z lambda.z.time.first lambda.z.n.points clast.pred</span></span>
<span><span class="co">## 1         FALSE    FALSE               FALSE             FALSE      FALSE</span></span>
<span><span class="co">## 2         FALSE    FALSE               FALSE             FALSE      FALSE</span></span>
<span><span class="co">## 3         FALSE    FALSE               FALSE             FALSE      FALSE</span></span>
<span><span class="co">## 4         FALSE    FALSE               FALSE             FALSE      FALSE</span></span>
<span><span class="co">##   span.ratio thalf.eff.last thalf.eff.iv.last kel.last kel.iv.last aucinf.obs</span></span>
<span><span class="co">## 1      FALSE          FALSE             FALSE    FALSE       FALSE      FALSE</span></span>
<span><span class="co">## 2      FALSE          FALSE             FALSE    FALSE       FALSE       TRUE</span></span>
<span><span class="co">## 3      FALSE          FALSE             FALSE    FALSE       FALSE      FALSE</span></span>
<span><span class="co">## 4      FALSE          FALSE             FALSE    FALSE       FALSE      FALSE</span></span>
<span><span class="co">##   aucinf.pred aumcinf.obs aumcinf.pred aucint.inf.obs aucint.inf.obs.dose</span></span>
<span><span class="co">## 1       FALSE       FALSE        FALSE          FALSE               FALSE</span></span>
<span><span class="co">## 2       FALSE       FALSE        FALSE          FALSE               FALSE</span></span>
<span><span class="co">## 3       FALSE       FALSE        FALSE          FALSE               FALSE</span></span>
<span><span class="co">## 4       FALSE       FALSE        FALSE          FALSE               FALSE</span></span>
<span><span class="co">##   aucint.inf.pred aucint.inf.pred.dose aucivinf.obs aucivinf.pred</span></span>
<span><span class="co">## 1           FALSE                FALSE        FALSE         FALSE</span></span>
<span><span class="co">## 2           FALSE                FALSE        FALSE         FALSE</span></span>
<span><span class="co">## 3           FALSE                FALSE        FALSE         FALSE</span></span>
<span><span class="co">## 4           FALSE                FALSE        FALSE         FALSE</span></span>
<span><span class="co">##   aucivpbextinf.obs aucivpbextinf.pred aucpext.obs aucpext.pred cl.obs cl.pred</span></span>
<span><span class="co">## 1             FALSE              FALSE       FALSE        FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 2             FALSE              FALSE       FALSE        FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 3             FALSE              FALSE       FALSE        FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 4             FALSE              FALSE       FALSE        FALSE  FALSE   FALSE</span></span>
<span><span class="co">##   mrt.obs mrt.pred mrt.iv.obs mrt.iv.pred mrt.md.obs mrt.md.pred vz.obs vz.pred</span></span>
<span><span class="co">## 1   FALSE    FALSE      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 2   FALSE    FALSE      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 3   FALSE    FALSE      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 4   FALSE    FALSE      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE</span></span>
<span><span class="co">##   vss.obs vss.pred vss.iv.obs vss.iv.pred vss.md.obs vss.md.pred vd.obs vd.pred</span></span>
<span><span class="co">## 1   FALSE    FALSE      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 2   FALSE    FALSE      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 3   FALSE    FALSE      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE</span></span>
<span><span class="co">## 4   FALSE    FALSE      FALSE       FALSE      FALSE       FALSE  FALSE   FALSE</span></span>
<span><span class="co">##   thalf.eff.obs thalf.eff.pred thalf.eff.iv.obs thalf.eff.iv.pred kel.obs</span></span>
<span><span class="co">## 1         FALSE          FALSE            FALSE             FALSE   FALSE</span></span>
<span><span class="co">## 2         FALSE          FALSE            FALSE             FALSE   FALSE</span></span>
<span><span class="co">## 3         FALSE          FALSE            FALSE             FALSE   FALSE</span></span>
<span><span class="co">## 4         FALSE          FALSE            FALSE             FALSE   FALSE</span></span>
<span><span class="co">##   kel.pred kel.iv.obs kel.iv.pred auclast.dn aucall.dn aucinf.obs.dn</span></span>
<span><span class="co">## 1    FALSE      FALSE       FALSE      FALSE     FALSE         FALSE</span></span>
<span><span class="co">## 2    FALSE      FALSE       FALSE      FALSE     FALSE         FALSE</span></span>
<span><span class="co">## 3    FALSE      FALSE       FALSE      FALSE     FALSE         FALSE</span></span>
<span><span class="co">## 4    FALSE      FALSE       FALSE      FALSE     FALSE         FALSE</span></span>
<span><span class="co">##   aucinf.pred.dn aumclast.dn aumcall.dn aumcinf.obs.dn aumcinf.pred.dn cmax.dn</span></span>
<span><span class="co">## 1          FALSE       FALSE      FALSE          FALSE           FALSE   FALSE</span></span>
<span><span class="co">## 2          FALSE       FALSE      FALSE          FALSE           FALSE   FALSE</span></span>
<span><span class="co">## 3          FALSE       FALSE      FALSE          FALSE           FALSE   FALSE</span></span>
<span><span class="co">## 4          FALSE       FALSE      FALSE          FALSE           FALSE   FALSE</span></span>
<span><span class="co">##   cmin.dn clast.obs.dn clast.pred.dn cav.dn ctrough.dn Study_Part</span></span>
<span><span class="co">## 1   FALSE        FALSE         FALSE  FALSE      FALSE     Single</span></span>
<span><span class="co">## 2   FALSE        FALSE         FALSE  FALSE      FALSE     Single</span></span>
<span><span class="co">## 3   FALSE        FALSE         FALSE  FALSE      FALSE   Multiple</span></span>
<span><span class="co">## 4   FALSE        FALSE         FALSE  FALSE      FALSE   Multiple</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="smaller" id="single--and-multiple-dose-single-analyte-use-intervals-for-fewer-subjects">Single- and Multiple-dose, single analyte: Use
intervals for fewer subjects<a class="anchor" aria-label="anchor" href="#single--and-multiple-dose-single-analyte-use-intervals-for-fewer-subjects"></a>
</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_intervals</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    start<span class="op">=</span><span class="fl">0</span>,</span>
<span>    end<span class="op">=</span><span class="fl">24</span>,</span>
<span>    Subject<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span>,</span>
<span>    Study_Part<span class="op">=</span><span class="st">"Single"</span>,</span>
<span>    aucinf.obs<span class="op">=</span><span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span>, intervals<span class="op">=</span><span class="va">d_intervals</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=3: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=4: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=5: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=6: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=7: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=8: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=9: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=10: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=11: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Single; Subject=12: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=1: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=2: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=3: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=4: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=5: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=6: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=7: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=8: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=9: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=10: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=11: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=12: No intervals for data</span></span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  start end Study_Part N aucinf.obs</span></span>
<span><span class="co">##      0  24     Single 2 144 [69.0]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: aucinf.obs: geometric mean and geometric coefficient of variation</span></span></code></pre>
</div>
<div class="section level3">
<h3 class="smaller" id="single--and-multiple-dose-single-analyte-use-custom-intervals-per-subjects">Single- and Multiple-dose, single analyte: Use
custom intervals per subjects<a class="anchor" aria-label="anchor" href="#single--and-multiple-dose-single-analyte-use-custom-intervals-per-subjects"></a>
</h3>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find the time closest to 12 hours</span></span>
<span><span class="va">d_intervals_prep</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">d_single_multi_conc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Study_Part</span> <span class="op">==</span> <span class="st">"Single"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    time_deviation<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">time</span><span class="op">-</span><span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Subject</span>, <span class="va">Study_Part</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">time</span><span class="op">[</span><span class="va">time_deviation</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">time_deviation</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">d_intervals</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">d_intervals_prep</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Study_Part</span>, <span class="va">Subject</span>, end<span class="op">=</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    start<span class="op">=</span><span class="fl">0</span>,</span>
<span>    aucinf.obs<span class="op">=</span><span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span>, intervals<span class="op">=</span><span class="va">d_intervals</span><span class="op">)</span></span>
<span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=1: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=2: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=3: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=4: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=5: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=6: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=7: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=8: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=9: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=10: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=11: No intervals for data</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Study_Part=Multiple; Subject=12: No intervals for data</span></span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span>, drop.group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Subject"</span>, <span class="st">"end"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in summary.PKNCAresults(o_nca, drop.group = c("Subject", "end")):</span></span>
<span><span class="co">## drop.group including start or end may result in incorrect groupings (such as</span></span>
<span><span class="co">## inaccurate comparison of intervals).  Drop these with care.</span></span></code></pre>
<pre><code><span><span class="co">##  start Study_Part  N aucinf.obs</span></span>
<span><span class="co">##      0     Single 12 120 [29.5]</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: aucinf.obs: geometric mean and geometric coefficient of variation</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="single--and-multiple-dose-parent-and-metabolite">Single- and Multiple-dose, parent and metabolite<a class="anchor" aria-label="anchor" href="#single--and-multiple-dose-parent-and-metabolite"></a>
</h3>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_single_multi_conc_multi_analyte</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>    <span class="va">d_single_multi_conc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Analyte<span class="op">=</span><span class="st">"Parent"</span><span class="op">)</span>,</span>
<span>    <span class="va">d_single_multi_conc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        Analyte<span class="op">=</span><span class="st">"Metabolite"</span>,</span>
<span>        conc<span class="op">=</span><span class="va">conc</span><span class="op">/</span><span class="fl">2</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span></span>
<span>    data<span class="op">=</span><span class="va">d_single_multi_conc_multi_analyte</span>,</span>
<span>    <span class="va">conc</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Study_Part</span><span class="op">+</span><span class="va">Subject</span><span class="op">/</span><span class="va">Analyte</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">d_single_multi_dose</span>, <span class="va">Dose</span><span class="op">~</span><span class="va">time</span><span class="op">|</span><span class="va">Study_Part</span><span class="op">+</span><span class="va">Subject</span><span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  start end Study_Part    Analyte  N     auclast        cmax               tmax</span></span>
<span><span class="co">##      0  24     Single     Parent 12 74.6 [24.3]           .                  .</span></span>
<span><span class="co">##      0 Inf     Single     Parent 12           . 8.65 [17.0] 1.14 [0.630, 3.55]</span></span>
<span><span class="co">##      0 120   Multiple     Parent 12  237 [38.0] 8.65 [17.0] 1.14 [0.630, 3.55]</span></span>
<span><span class="co">##    120 144   Multiple     Parent 12  115 [28.4] 10.0 [21.0] 1.09 [0.630, 3.55]</span></span>
<span><span class="co">##      0  24     Single Metabolite 12 37.3 [24.3]           .                  .</span></span>
<span><span class="co">##      0 Inf     Single Metabolite 12           . 4.32 [17.0] 1.14 [0.630, 3.55]</span></span>
<span><span class="co">##      0 120   Multiple Metabolite 12  118 [38.0] 4.32 [17.0] 1.14 [0.630, 3.55]</span></span>
<span><span class="co">##    120 144   Multiple Metabolite 12 57.4 [28.4] 5.02 [21.0] 1.09 [0.630, 3.55]</span></span>
<span><span class="co">##    half.life  aucinf.obs</span></span>
<span><span class="co">##            .           .</span></span>
<span><span class="co">##  8.18 [2.12]  115 [28.4]</span></span>
<span><span class="co">##            .           .</span></span>
<span><span class="co">##            .           .</span></span>
<span><span class="co">##            .           .</span></span>
<span><span class="co">##  8.18 [2.12] 57.4 [28.4]</span></span>
<span><span class="co">##            .           .</span></span>
<span><span class="co">##            .           .</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Caption: auclast, cmax, aucinf.obs: geometric mean and geometric coefficient of variation; tmax: median and range; half.life: arithmetic mean and standard deviation</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
