<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Superposition of Pharmacokinetic Data • PKNCA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Superposition of Pharmacokinetic Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PKNCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01-introduction-and-usage.html">Introduction to PKNCA and Usage Instructions</a></li>
    <li><a class="dropdown-item" href="../articles/v02-example-theophylline.html">Computing NCA Parameters for Theophylline</a></li>
    <li><a class="dropdown-item" href="../articles/v03-selection-of-calculation-intervals.html">Selection of Calculation Intervals</a></li>
    <li><a class="dropdown-item" href="../articles/v04-sparse.html">Sparse NCA Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/v05-auc-calculation-with-PKNCA.html">AUC Calculation with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation-tobit.html">Half-life calculation with Tobit regression</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation.html">Half-Life Calculation</a></li>
    <li><a class="dropdown-item" href="../articles/v07-post-processing.html">Post-Processing</a></li>
    <li><a class="dropdown-item" href="../articles/v07-unit-conversion.html">Unit Assignment and Conversion with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v08-data-imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/v20-superposition.html">Superposition of Pharmacokinetic Data</a></li>
    <li><a class="dropdown-item" href="../articles/v21-methods-for-dose-aware-interpolation-and-extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a></li>
    <li><a class="dropdown-item" href="../articles/v22-time-to-steady-state.html">Noncompartmental evaluation of time to steady-state</a></li>
    <li><a class="dropdown-item" href="../articles/v23-auc-integration-methods.html">AUC integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/v30-training-session.html">PKNCA Training Sessions</a></li>
    <li><a class="dropdown-item" href="../articles/v40-options-for-controlling-PKNCA.html">Options for Controlling PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v60-PKNCA-validation.html">PKNCA Validation</a></li>
    <li><a class="dropdown-item" href="../articles/v80-writing-parameter-functions.html">Writing PKNCA Parameter Functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/humanpred/pknca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Superposition of Pharmacokinetic Data</h1>
                        <h4 data-toc-skip class="author">Bill
Denney</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/humanpred/pknca/blob/main/vignettes/v20-superposition.Rmd" class="external-link"><code>vignettes/v20-superposition.Rmd</code></a></small>
      <div class="d-none name"><code>v20-superposition.Rmd</code></div>
    </div>

    
    
<p>Examples simplify understanding. Below is an example of how to use
the theophylline dataset to estimate the concentration for each subject
after multiple doses.</p>
<div class="section level2">
<h2 id="load-the-data">Load the data<a class="anchor" aria-label="anchor" href="#load-the-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## It is always a good idea to look at the data</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Subject</th>
<th align="right">Wt</th>
<th align="right">Dose</th>
<th align="right">Time</th>
<th align="right">conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">0.00</td>
<td align="right">0.74</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">0.25</td>
<td align="right">2.84</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">0.57</td>
<td align="right">6.57</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">1.12</td>
<td align="right">10.50</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">2.02</td>
<td align="right">9.66</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">3.82</td>
<td align="right">8.58</td>
</tr>
</tbody>
</table>
<p>The columns that we will be interested in for our analysis are conc,
Time, and Subject in the concentration data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## By default it is groupedData; convert it to a data frame for use</span></span>
<span><span class="va">conc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compute-the-superposition-from-single-dose-data-to-steady-state">Compute the Superposition from Single-Dose Data to Steady-State<a class="anchor" aria-label="anchor" href="#compute-the-superposition-from-single-dose-data-to-steady-state"></a>
</h2>
<p>With a simple call, we can have the estimated steady-state
concentration for each subject. At minimum, the time between dosing
(<code>tau</code>) must be provided.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">steady_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span><span class="va">conc_obj</span>, tau<span class="op">=</span><span class="fl">24</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in parallel::mclapply(X = seq_len(nrow(nested_data)), FUN =</span></span>
<span><span class="co">## function(idx) {: all scheduled cores encountered errors in user code</span></span></code></pre>
<p>The error noting that the first concentration must be zero is due to
the fact that superposition usually occurs with single-dose data. If the
first concentration is nonzero, the data are not likely to be
single-dose (or a data error should be fixed). Let’s find the offending
data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span>, <span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">conc</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             caption<span class="op">=</span><span class="st">"Nonzero predose measurements"</span>,</span>
<span>             row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Nonzero predose measurements</caption>
<thead><tr class="header">
<th align="left">Subject</th>
<th align="right">Wt</th>
<th align="right">Dose</th>
<th align="right">Time</th>
<th align="right">conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">79.6</td>
<td align="right">4.02</td>
<td align="right">0</td>
<td align="right">0.74</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">64.6</td>
<td align="right">4.95</td>
<td align="right">0</td>
<td align="right">0.15</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">58.2</td>
<td align="right">5.50</td>
<td align="right">0</td>
<td align="right">0.24</td>
</tr>
</tbody>
</table>
<p>For this example, we will assume that these were errors, correct them
to zero, and recalculate.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Correct nonzero concentrations at time 0 to be BLQ.</span></span>
<span><span class="va">theoph_corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">theoph_corrected</span><span class="op">$</span><span class="va">conc</span><span class="op">[</span><span class="va">theoph_corrected</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">conc_obj_corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">theoph_corrected</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate the new steady-state concentrations with 24 hour dosing</span></span>
<span><span class="va">steady_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span><span class="va">conc_obj_corrected</span>, tau<span class="op">=</span><span class="fl">24</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">steady_state</span>, n<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>             caption<span class="op">=</span><span class="st">"Superposition at steady-state"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Superposition at steady-state</caption>
<thead><tr class="header">
<th align="left">Subject</th>
<th align="right">conc</th>
<th align="right">time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">4.856234</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">7.637741</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">9.008665</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">11.293912</td>
<td align="right">0.57</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.099676</td>
<td align="right">1.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">14.063389</td>
<td align="right">2.02</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">12.615588</td>
<td align="right">3.82</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">12.152885</td>
<td align="right">5.10</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">10.924249</td>
<td align="right">7.03</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">10.022157</td>
<td align="right">9.05</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">8.639209</td>
<td align="right">12.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">4.857207</td>
<td align="right">24.00</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">1.010060</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">2.703513</td>
<td align="right">0.27</td>
</tr>
</tbody>
</table>
<p>The output is a tbl_df, tbl, data.frame including all the grouping
factors as columns, a column for <code>conc</code>entration, and a
column for <code>time</code>. Time point selection ensures that the
beginning and end of the interval are included and that every measured
time that contributes to the interval is included. The points at the
beginning and end of the interval are very similar; they are within a
tolerance of 0.001 as defined by the <code>steady.state.tol</code>
argument to superposition.</p>
</div>
<div class="section level2">
<h2 id="nonstandard-superposition-computations">Nonstandard Superposition Computations<a class="anchor" aria-label="anchor" href="#nonstandard-superposition-computations"></a>
</h2>
<div class="section level3">
<h3 id="compute-the-superposition-from-single-dose-data-to-a-specific-dose">Compute the Superposition from Single-Dose Data to a Specific
Dose<a class="anchor" aria-label="anchor" href="#compute-the-superposition-from-single-dose-data-to-a-specific-dose"></a>
</h3>
<p>If simulation to a specific dose is needed, the number of dosing
intervals (<code>n.tau</code>) can be specified.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Calculate the unsteady-state concentrations with 24 hour dosing</span></span>
<span><span class="va">unsteady_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span><span class="va">conc_obj_corrected</span>, tau<span class="op">=</span><span class="fl">24</span>, n.tau<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">unsteady_state</span>, n<span class="op">=</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>             caption<span class="op">=</span><span class="st">"Superposition before steady-state"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Superposition before steady-state</caption>
<thead><tr class="header">
<th align="left">Subject</th>
<th align="right">conc</th>
<th align="right">time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">3.3393647</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">6.1391369</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">7.5187500</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">9.8183657</td>
<td align="right">0.57</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">13.6629359</td>
<td align="right">1.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">12.6879608</td>
<td align="right">2.02</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">11.3550445</td>
<td align="right">3.82</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">10.9681517</td>
<td align="right">5.10</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">9.8452907</td>
<td align="right">7.03</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">9.0438064</td>
<td align="right">9.05</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">7.7960929</td>
<td align="right">12.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">4.3830987</td>
<td align="right">24.00</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">0.9268958</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">2.6226541</td>
<td align="right">0.27</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="compute-the-superposition-from-single-dose-data-with-1-dose-per-interval">Compute the Superposition from Single-Dose Data with &gt;1 Dose Per
Interval<a class="anchor" aria-label="anchor" href="#compute-the-superposition-from-single-dose-data-with-1-dose-per-interval"></a>
</h3>
<p>Some dosing intervals are more complex than once per X hours (or days
or weeks or…). To predict more complex dosing with superposition, give
the dose times within the interval. The <code>dose.times</code> must all
be less than <code>tau</code> (otherwise they are not in the
interval).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Calculate the new steady-state concentrations with 24 hour dosing</span></span>
<span><span class="va">complex_interval_steady_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span><span class="va">conc_obj_corrected</span>, tau<span class="op">=</span><span class="fl">24</span>, dose.times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">complex_interval_steady_state</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>             caption<span class="op">=</span><span class="st">"Superposition at steady-state with complex dosing"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Superposition at steady-state with complex dosing</caption>
<thead><tr class="header">
<th align="left">Subject</th>
<th align="right">conc</th>
<th align="right">time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">16.10210</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">18.74815</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">20.05464</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">22.23332</td>
<td align="right">0.57</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">25.75130</td>
<td align="right">1.12</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">24.29240</td>
<td align="right">2.00</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">24.48753</td>
<td align="right">2.02</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">26.79323</td>
<td align="right">2.25</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">28.03334</td>
<td align="right">2.37</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">30.10259</td>
<td align="right">2.57</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">complex_interval_steady_state</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">conc</span>, x<span class="op">=</span><span class="va">time</span>, colour<span class="op">=</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="v20-superposition_files/figure-html/ComplexInterval-visualization-1.png" width="700"></p>
<p>With this more complex dosing interval, the number of time points
estimated increases. The next section describes the selection of time
points.</p>
<div class="section level4">
<h4 id="show-the-curve-to-steady-state">Show the Curve to Steady-State<a class="anchor" aria-label="anchor" href="#show-the-curve-to-steady-state"></a>
</h4>
<p>To determine the concentration curve to get to steady-state, you can
give all the dose times considered required to get to steady-state. To
do this, specify tau as the total time to steady-state, specify
<code>n.tau</code> as <code>1</code> to indicate that only one round of
dosing should be administered.</p>
<p>This command does not technically go to steady-state; if the
<code>dose.times</code> are not sufficiently long to reach steady-state,
it only goes for as many doses as requested.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">up_to_steady_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span><span class="va">conc_obj_corrected</span>,</span>
<span>                                    tau<span class="op">=</span><span class="fl">4</span><span class="op">*</span><span class="fl">24</span>,</span>
<span>                                    n.tau<span class="op">=</span><span class="fl">1</span>,</span>
<span>                                    dose.times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">*</span><span class="fl">24</span>, by<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">up_to_steady_state</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">conc</span>, colour<span class="op">=</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="v20-superposition_files/figure-html/to_steady_state-visualization-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="time-point-selection-and-addition">Time Point Selection and Addition<a class="anchor" aria-label="anchor" href="#time-point-selection-and-addition"></a>
</h2>
<p>Superposition is often used to estimate NCA parameters with
nonparametric methods. To ensure that estimated parameters are as
accurate as possible (especially
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">C_{max}</annotation></semantics></math>),
each dose has every post-dose time point included. Specifically, each
dose will have the following times:</p>
<ul>
<li>0 (zero) and <code>tau</code>,</li>
<li>The time of each dose (the <code>dose.times</code> argument)</li>
<li>Every value from the time column of the data modulo <code>tau</code>
(shifting the time for each measurement to be within the dosing
interval) repeated for each dose, and</li>
<li>each time from the <code>additional.times</code> argument.</li>
</ul>
<p>How the number of time points increases can be seen by comparing the
time points for subject 1 in the steady-state single dosing and the
complex dosing examples above.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">steady_state</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">steady_state</span><span class="op">$</span><span class="va">Subject</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1]  0.00  0.25  0.37  0.57  1.12  2.02  3.82  5.10  7.03  9.05 12.12 24.00</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">steady_state</span><span class="op">$</span><span class="va">Subject</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 12</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complex_interval_steady_state</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="va">complex_interval_steady_state</span><span class="op">$</span><span class="va">Subject</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1]  0.00  0.25  0.37  0.57  1.12  2.00  2.02  2.25  2.37  2.57  3.12  3.82</span></span>
<span><span class="co">## [13]  4.00  4.02  4.25  4.37  4.57  5.10  5.12  5.82  6.02  7.03  7.10  7.82</span></span>
<span><span class="co">## [25]  9.03  9.05  9.10 11.03 11.05 12.12 13.05 14.12 16.12 24.00</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">complex_interval_steady_state</span><span class="op">$</span><span class="va">Subject</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 34</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="interpolation-and-extrapolation-methods">Interpolation and Extrapolation Methods<a class="anchor" aria-label="anchor" href="#interpolation-and-extrapolation-methods"></a>
</h2>
<p>The interpolation and extrapolation methods align with those used for
calculating the AUC. By default, interpolation uses the
<code>PKNCA.options</code> selection for <code>"auc.method"</code> and
extrapolation follows the curve of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>U</mi><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi><mi>f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">AUC_{inf}</annotation></semantics></math>.
These can be modified with the <code>interp.method</code> and
<code>extrap.method</code> arguments.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
