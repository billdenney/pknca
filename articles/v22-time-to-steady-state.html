<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Noncompartmental evaluation of time to steady-state â€¢ PKNCA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Noncompartmental evaluation of time to steady-state">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PKNCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01-introduction-and-usage.html">Introduction to PKNCA and Usage Instructions</a></li>
    <li><a class="dropdown-item" href="../articles/v02-example-theophylline.html">Computing NCA Parameters for Theophylline</a></li>
    <li><a class="dropdown-item" href="../articles/v03-selection-of-calculation-intervals.html">Selection of Calculation Intervals</a></li>
    <li><a class="dropdown-item" href="../articles/v04-sparse.html">Sparse NCA Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/v05-auc-calculation-with-PKNCA.html">AUC Calculation with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation-tobit.html">Half-life calculation with Tobit regression</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation.html">Half-Life Calculation</a></li>
    <li><a class="dropdown-item" href="../articles/v07-post-processing.html">Post-Processing</a></li>
    <li><a class="dropdown-item" href="../articles/v07-unit-conversion.html">Unit Assignment and Conversion with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v08-data-imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/v20-superposition.html">Superposition of Pharmacokinetic Data</a></li>
    <li><a class="dropdown-item" href="../articles/v21-methods-for-dose-aware-interpolation-and-extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a></li>
    <li><a class="dropdown-item" href="../articles/v22-time-to-steady-state.html">Noncompartmental evaluation of time to steady-state</a></li>
    <li><a class="dropdown-item" href="../articles/v23-auc-integration-methods.html">AUC integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/v30-training-session.html">PKNCA Training Sessions</a></li>
    <li><a class="dropdown-item" href="../articles/v40-options-for-controlling-PKNCA.html">Options for Controlling PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v60-PKNCA-validation.html">PKNCA Validation</a></li>
    <li><a class="dropdown-item" href="../articles/v80-writing-parameter-functions.html">Writing PKNCA Parameter Functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/billdenney/pknca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Noncompartmental evaluation of time to steady-state</h1>
                        <h4 data-toc-skip class="author">Bill
Denney</h4>
            
            <h4 data-toc-skip class="date">2025-05-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/billdenney/pknca/blob/main/vignettes/v22-time-to-steady-state.Rmd" class="external-link"><code>vignettes/v22-time-to-steady-state.Rmd</code></a></small>
      <div class="d-none name"><code>v22-time-to-steady-state.Rmd</code></div>
    </div>

    
    
<p>Time to steady-state (TSS) can be estimated with PKNCA using either a
monoexponential increase toward an asymptote or by a linear regression
of the last points. According to Maganti (2008), the monoexponential
method is preferred.</p>
<p>TSS can be estimated using either method using the
<code><a href="../reference/pk.tss.html">pk.tss()</a></code> function in PKNCA.</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="data-setup">Data setup<a class="anchor" aria-label="anchor" href="#data-setup"></a>
</h3>
<p>Illustrating time to steady-state, the example from the <a href="v20-superposition.html">superposition vignette</a> will be
used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/" class="external-link">PKNCA</a></span><span class="op">)</span></span>
<span><span class="va">theoph_corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">theoph_corrected</span><span class="op">$</span><span class="va">conc</span><span class="op">[</span><span class="va">theoph_corrected</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">conc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">theoph_corrected</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span></span>
<span><span class="va">steady_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span><span class="va">conc_obj</span>, dose.times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">168</span> <span class="op">-</span> <span class="fl">12</span>, by<span class="op">=</span><span class="fl">12</span><span class="op">)</span>, tau<span class="op">=</span><span class="fl">168</span>, n.tau<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Add some noise to the data so that it seems more reasonable</span></span>
<span><span class="va">steady_state_noise</span> <span class="op">&lt;-</span> <span class="va">steady_state</span></span>
<span><span class="va">steady_state_noise</span><span class="op">$</span><span class="va">conc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html" class="external-link">with_seed</a></span><span class="op">(</span></span>
<span>    seed <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">conc</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">steady_state_noise</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Examine the data graphically.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">steady_state_noise</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">conc</span>, groups<span class="op">=</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="v22-time-to-steady-state_files/figure-html/superposition-fig-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="estimate-time-to-steady-state">Estimate time to Steady State<a class="anchor" aria-label="anchor" href="#estimate-time-to-steady-state"></a>
</h3>
<div class="section level4">
<h4 id="monoexponential">Monoexponential<a class="anchor" aria-label="anchor" href="#monoexponential"></a>
</h4>
<p>The below code estimates four different types of monoexponential time
to steady-state:</p>
<ol style="list-style-type: decimal">
<li>tss.monoexponential.population: The population estimate of TSS using
a nonlinear mixed effects model (one value for all subjects)</li>
<li>tss.monoexponential.popind: The individual estimate from a nonlinear
mixed effects model (one value per subject)</li>
<li>tss.monoexponential.individual: The individual estimate using a gnls
model to estimate each subject separately (one value per subject)</li>
<li>tss.monoexponential.single: The mean estimate of TSS using a
nonlinear model</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_mono</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pk.tss.monoexponential.html">pk.tss.monoexponential</a></span><span class="op">(</span></span>
<span>    conc <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">time</span>,</span>
<span>    subject <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">Subject</span>,</span>
<span>    time.dosing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">168</span> <span class="op">-</span> <span class="fl">12</span>, by<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning in nlme.formula(conc ~ ctrough.ss * (1 - exp(tss.constant * time/tss)),</span></span>
<span><span class="co">#&gt; : Iteration 1, LME step: nlminb() did not converge (code = 1). Do increase</span></span>
<span><span class="co">#&gt; 'msMaxIter'!</span></span>
<span><span class="va">tss_mono</span></span>
<span><span class="co">#&gt;    subject tss.monoexponential.population tss.monoexponential.popind</span></span>
<span><span class="co">#&gt; 1        1                       26.41698                   36.94302</span></span>
<span><span class="co">#&gt; 2       10                       26.41698                   31.95467</span></span>
<span><span class="co">#&gt; 3       11                       26.41698                   22.79693</span></span>
<span><span class="co">#&gt; 4       12                       26.41698                   26.59837</span></span>
<span><span class="co">#&gt; 5        2                       26.41698                   23.53946</span></span>
<span><span class="co">#&gt; 6        3                       26.41698                   24.72265</span></span>
<span><span class="co">#&gt; 7        4                       26.41698                   25.73792</span></span>
<span><span class="co">#&gt; 8        5                       26.41698                   26.93388</span></span>
<span><span class="co">#&gt; 9        6                       26.41698                   23.21909</span></span>
<span><span class="co">#&gt; 10       7                       26.41698                   25.39792</span></span>
<span><span class="co">#&gt; 11       8                       26.41698                   24.54268</span></span>
<span><span class="co">#&gt; 12       9                       26.41698                   24.61721</span></span>
<span><span class="co">#&gt;    tss.monoexponential.individual tss.monoexponential.single</span></span>
<span><span class="co">#&gt; 1                        40.65290                   27.87592</span></span>
<span><span class="co">#&gt; 2                        24.72591                   27.87592</span></span>
<span><span class="co">#&gt; 3                        20.18663                   27.87592</span></span>
<span><span class="co">#&gt; 4                        22.58610                   27.87592</span></span>
<span><span class="co">#&gt; 5                        25.45251                   27.87592</span></span>
<span><span class="co">#&gt; 6                        29.97015                   27.87592</span></span>
<span><span class="co">#&gt; 7                        21.60401                   27.87592</span></span>
<span><span class="co">#&gt; 8                        25.04023                   27.87592</span></span>
<span><span class="co">#&gt; 9                        23.53884                   27.87592</span></span>
<span><span class="co">#&gt; 10                       31.37369                   27.87592</span></span>
<span><span class="co">#&gt; 11                       32.02870                   27.87592</span></span>
<span><span class="co">#&gt; 12                       26.01334                   27.87592</span></span></code></pre></div>
<p>The fraction of steady-state required for time to steady-state can be
changed with the <code>tss.fraction</code> argument (see
<code><a href="../reference/pk.tss.monoexponential.html">?pk.tss.monoexponential</a></code>).</p>
</div>
<div class="section level4">
<h4 id="stepwise-linear">Stepwise Linear<a class="anchor" aria-label="anchor" href="#stepwise-linear"></a>
</h4>
<p>The stepwise linear method estimates if the slope of the predose
concentrations is statistically significant starting from the last
measurement and moving backward in time. It has bias in that more
individuals will move the time to steady-state to a late time point.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_step</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pk.tss.stepwise.linear.html">pk.tss.stepwise.linear</a></span><span class="op">(</span></span>
<span>    conc <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">time</span>,</span>
<span>    subject <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">Subject</span>,</span>
<span>    time.dosing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">168</span> <span class="op">-</span> <span class="fl">12</span>, by<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">tss_step</span></span>
<span><span class="co">#&gt;   tss.stepwise.linear</span></span>
<span><span class="co">#&gt; 1                 108</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Maganti, L., Panebianco, D.L. &amp; Maes, A.L. Evaluation of Methods
for Estimating Time to Steady State with Examples from Phase 1 Studies.
AAPS J 10, 141â€“147 (2008). <a href="https://doi.org/10.1208/s12248-008-9014-y" class="external-link uri">https://doi.org/10.1208/s12248-008-9014-y</a>
</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
