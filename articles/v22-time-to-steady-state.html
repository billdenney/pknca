<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Noncompartmental evaluation of time to steady-state • PKNCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Noncompartmental evaluation of time to steady-state">
<meta property="og:description" content="PKNCA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PKNCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.5.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v01-introduction-and-usage.html">Introduction to PKNCA and Usage Instructions</a>
    </li>
    <li>
      <a href="../articles/v02-example-theophylline.html">Computing NCA Parameters for Theophylline</a>
    </li>
    <li>
      <a href="../articles/v03-selection-of-calculation-intervals.html">Selection of Calculation Intervals</a>
    </li>
    <li>
      <a href="../articles/v04-sparse.html">Sparse NCA Calculations</a>
    </li>
    <li>
      <a href="../articles/v05-auc-calculation-with-PKNCA.html">AUC Calculation with PKNCA</a>
    </li>
    <li>
      <a href="../articles/v06-half-life-calculation.html">Half-Life Calculation</a>
    </li>
    <li>
      <a href="../articles/v07-post-processing.html">Post-Processing</a>
    </li>
    <li>
      <a href="../articles/v07-unit-conversion.html">Unit Assignment and Conversion with PKNCA</a>
    </li>
    <li>
      <a href="../articles/v20-superposition.html">Superposition of Pharmacokinetic Data</a>
    </li>
    <li>
      <a href="../articles/v21-methods-for-dose-aware-interpolation-and-extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a>
    </li>
    <li>
      <a href="../articles/v22-time-to-steady-state.html">Noncompartmental evaluation of time to steady-state</a>
    </li>
    <li>
      <a href="../articles/v30-training-session.html">PKNCA Training Sessions</a>
    </li>
    <li>
      <a href="../articles/v40-options-for-controlling-PKNCA.html">Options for Controlling PKNCA</a>
    </li>
    <li>
      <a href="../articles/v60-PKNCA-validation.html">PKNCA Validation</a>
    </li>
    <li>
      <a href="../articles/v80-writing-parameter-functions.html">Writing PKNCA Parameter Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/billdenney/pknca/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Noncompartmental evaluation of time to steady-state</h1>
                        <h4 data-toc-skip class="author">Bill Denney</h4>
            
            <h4 data-toc-skip class="date">2022-10-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/billdenney/pknca/blob/HEAD/vignettes/v22-time-to-steady-state.Rmd" class="external-link"><code>vignettes/v22-time-to-steady-state.Rmd</code></a></small>
      <div class="hidden name"><code>v22-time-to-steady-state.Rmd</code></div>

    </div>

    
    
<p>Time to steady-state (TSS) can be estimated with PKNCA using either a monoexponential increase toward an asymptote or by a linear regression of the last points. According to Maganti (2008), the monoexponential method is preferred.</p>
<p>TSS can be estimated using either method using the <code><a href="../reference/pk.tss.html">pk.tss()</a></code> function in PKNCA.</p>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="data-setup">Data setup<a class="anchor" aria-label="anchor" href="#data-setup"></a>
</h3>
<p>Illustrating time to steady-state, the example from the <a href="v20-superposition.html">superposition vignette</a> will be used.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/" class="external-link">PKNCA</a></span><span class="op">)</span></span>
<span><span class="va">theoph_corrected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">theoph_corrected</span><span class="op">$</span><span class="va">conc</span><span class="op">[</span><span class="va">theoph_corrected</span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">conc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">theoph_corrected</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span></span>
<span><span class="va">steady_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superposition.html">superposition</a></span><span class="op">(</span><span class="va">conc_obj</span>, dose.times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">168</span> <span class="op">-</span> <span class="fl">12</span>, by<span class="op">=</span><span class="fl">12</span><span class="op">)</span>, tau<span class="op">=</span><span class="fl">168</span>, n.tau<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Add some noise to the data so that it seems more reasonable</span></span>
<span><span class="va">steady_state_noise</span> <span class="op">&lt;-</span> <span class="va">steady_state</span></span>
<span><span class="va">steady_state_noise</span><span class="op">$</span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">conc</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">steady_state_noise</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Examine the data graphically.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">steady_state_noise</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">time</span>, y<span class="op">=</span><span class="va">conc</span>, groups<span class="op">=</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="v22-time-to-steady-state_files/figure-html/superposition-fig-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="estimate-time-to-steady-state">Estimate time to Steady State<a class="anchor" aria-label="anchor" href="#estimate-time-to-steady-state"></a>
</h3>
<div class="section level4">
<h4 id="monoexponential">Monoexponential<a class="anchor" aria-label="anchor" href="#monoexponential"></a>
</h4>
<p>The below code estimates four different types of monoexponential time to steady-state:</p>
<ol style="list-style-type: decimal">
<li>tss.monoexponential.population: The population estimate of TSS using a nonlinear mixed effects model (one value for all subjects)</li>
<li>tss.monoexponential.popind: The individual estimate from a nonlinear mixed effects model (one value per subject)</li>
<li>tss.monoexponential.individual: The individual estimate using a gnls model to estimate each subject separately (one value per subject)</li>
<li>tss.monoexponential.single: The mean estiamte of TSS using a nonlinear model</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_mono</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pk.tss.monoexponential.html">pk.tss.monoexponential</a></span><span class="op">(</span></span>
<span>    conc <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">time</span>,</span>
<span>    subject <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">Subject</span>,</span>
<span>    time.dosing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">168</span> <span class="op">-</span> <span class="fl">12</span>, by<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning in nlme.formula(conc ~ ctrough.ss * (1 - exp(tss.constant * time/</span></span>
<span><span class="co">#&gt; tss)), : Iteration 1, LME step: nlminb() did not converge (code = 1). Do</span></span>
<span><span class="co">#&gt; increase 'msMaxIter'!</span></span>
<span><span class="co">#&gt; Warning in nlme.formula(conc ~ ctrough.ss * (1 - exp(tss.constant * time/</span></span>
<span><span class="co">#&gt; tss)), : Singular precision matrix in level -1, block 1</span></span>
<span><span class="va">tss_mono</span></span>
<span><span class="co">#&gt;    subject tss.monoexponential.population tss.monoexponential.popind</span></span>
<span><span class="co">#&gt; 1        1                       27.07868                   46.14390</span></span>
<span><span class="co">#&gt; 2       10                       27.07868                   35.61582</span></span>
<span><span class="co">#&gt; 3       11                       27.07868                   21.28500</span></span>
<span><span class="co">#&gt; 4       12                       27.07868                   27.21991</span></span>
<span><span class="co">#&gt; 5        2                       27.07868                   21.75230</span></span>
<span><span class="co">#&gt; 6        3                       27.07868                   24.89766</span></span>
<span><span class="co">#&gt; 7        4                       27.07868                   25.98023</span></span>
<span><span class="co">#&gt; 8        5                       27.07868                   29.15396</span></span>
<span><span class="co">#&gt; 9        6                       27.07868                   21.45445</span></span>
<span><span class="co">#&gt; 10       7                       27.07868                   24.24893</span></span>
<span><span class="co">#&gt; 11       8                       27.07868                   24.15776</span></span>
<span><span class="co">#&gt; 12       9                       27.07868                   23.03427</span></span>
<span><span class="co">#&gt;    tss.monoexponential.individual tss.monoexponential.single</span></span>
<span><span class="co">#&gt; 1                        48.91051                   29.73119</span></span>
<span><span class="co">#&gt; 2                        29.78224                   29.73119</span></span>
<span><span class="co">#&gt; 3                        31.77675                   29.73119</span></span>
<span><span class="co">#&gt; 4                        23.49958                   29.73119</span></span>
<span><span class="co">#&gt; 5                        18.56632                   29.73119</span></span>
<span><span class="co">#&gt; 6                        21.44897                   29.73119</span></span>
<span><span class="co">#&gt; 7                        21.60315                   29.73119</span></span>
<span><span class="co">#&gt; 8                        32.23187                   29.73119</span></span>
<span><span class="co">#&gt; 9                        25.77302                   29.73119</span></span>
<span><span class="co">#&gt; 10                       25.71758                   29.73119</span></span>
<span><span class="co">#&gt; 11                       33.13911                   29.73119</span></span>
<span><span class="co">#&gt; 12                       21.70858                   29.73119</span></span></code></pre></div>
<p>The fraction of steady-state required for time to steady-state can be changed with the <code>tss.fraction</code> argument (see <code><a href="../reference/pk.tss.monoexponential.html">?pk.tss.monoexponential</a></code>).</p>
</div>
<div class="section level4">
<h4 id="stepwise-linear">Stepwise Linear<a class="anchor" aria-label="anchor" href="#stepwise-linear"></a>
</h4>
<p>The stepwise linear method estimates if the slope of the predose concentrations is statistically significant starting from the last measurement and moving backward in time. It has bias in that more individuals will move the time to steady-state to a late time point.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tss_step</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pk.tss.stepwise.linear.html">pk.tss.stepwise.linear</a></span><span class="op">(</span></span>
<span>    conc <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">conc</span>,</span>
<span>    time <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">time</span>,</span>
<span>    subject <span class="op">=</span> <span class="va">steady_state_noise</span><span class="op">$</span><span class="va">Subject</span>,</span>
<span>    time.dosing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">168</span> <span class="op">-</span> <span class="fl">12</span>, by<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">tss_step</span></span>
<span><span class="co">#&gt;   tss.stepwise.linear</span></span>
<span><span class="co">#&gt; 1                  72</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Maganti, L., Panebianco, D.L. &amp; Maes, A.L. Evaluation of Methods for Estimating Time to Steady State with Examples from Phase 1 Studies. AAPS J 10, 141–147 (2008). <a href="https://doi.org/10.1208/s12248-008-9014-y" class="external-link uri">https://doi.org/10.1208/s12248-008-9014-y</a>
</li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
