<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Unit Assignment and Conversion with PKNCA • PKNCA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Unit Assignment and Conversion with PKNCA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PKNCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01-introduction-and-usage.html">Introduction to PKNCA and Usage Instructions</a></li>
    <li><a class="dropdown-item" href="../articles/v02-example-theophylline.html">Computing NCA Parameters for Theophylline</a></li>
    <li><a class="dropdown-item" href="../articles/v03-selection-of-calculation-intervals.html">Selection of Calculation Intervals</a></li>
    <li><a class="dropdown-item" href="../articles/v04-sparse.html">Sparse NCA Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/v05-auc-calculation-with-PKNCA.html">AUC Calculation with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation-tobit.html">Half-life calculation with Tobit regression</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation.html">Half-Life Calculation</a></li>
    <li><a class="dropdown-item" href="../articles/v07-post-processing.html">Post-Processing</a></li>
    <li><a class="dropdown-item" href="../articles/v07-unit-conversion.html">Unit Assignment and Conversion with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v08-data-imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/v20-superposition.html">Superposition of Pharmacokinetic Data</a></li>
    <li><a class="dropdown-item" href="../articles/v21-methods-for-dose-aware-interpolation-and-extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a></li>
    <li><a class="dropdown-item" href="../articles/v22-time-to-steady-state.html">Noncompartmental evaluation of time to steady-state</a></li>
    <li><a class="dropdown-item" href="../articles/v23-auc-integration-methods.html">AUC integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/v30-training-session.html">PKNCA Training Sessions</a></li>
    <li><a class="dropdown-item" href="../articles/v40-options-for-controlling-PKNCA.html">Options for Controlling PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v60-PKNCA-validation.html">PKNCA Validation</a></li>
    <li><a class="dropdown-item" href="../articles/v80-writing-parameter-functions.html">Writing PKNCA Parameter Functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/billdenney/pknca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Unit Assignment and Conversion with PKNCA</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/billdenney/pknca/blob/main/vignettes/v07-unit-conversion.Rmd" class="external-link"><code>vignettes/v07-unit-conversion.Rmd</code></a></small>
      <div class="d-none name"><code>v07-unit-conversion.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://billdenney.github.io/pknca/" class="external-link">PKNCA</a></span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>PKNCA can assign and convert units for reporting. There are two ways
to provide units to PKNCA: via the <code>units</code> argument to
<code><a href="../reference/PKNCAdata.html">PKNCAdata()</a></code> or by specifying units with
<code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code> and/or <code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code>. If you provide
the units argument to <code><a href="../reference/PKNCAdata.html">PKNCAdata()</a></code>, units given to
<code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code> or <code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code> are ignored.</p>
</div>
<div class="section level2">
<h2 id="examples-of-each-way-to-add-units">Examples of each way to add units<a class="anchor" aria-label="anchor" href="#examples-of-each-way-to-add-units"></a>
</h2>
<div class="section level3">
<h3 id="steps-to-add-units-to-an-nca-analysis-from-the-data">Steps to add units to an NCA analysis from the data<a class="anchor" aria-label="anchor" href="#steps-to-add-units-to-an-nca-analysis-from-the-data"></a>
</h3>
<p>For more details on parts of this NCA calculation example unrelated
to units, see the <a href="v02-example-theophylline.html">theophylline
example vignette</a>.</p>
<p>Provide the units for concentration (<code>concu</code>), time
(<code>timeu</code>), and amount (<code>amountu</code>) to the
<code><a href="../reference/PKNCAconc.html">PKNCAconc()</a></code> function and for dose (<code>doseu</code>) to
the <code><a href="../reference/PKNCAdose.html">PKNCAdose()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">d_conc</span><span class="op">$</span><span class="va">concu_col</span> <span class="op">&lt;-</span> <span class="st">"mg/L"</span></span>
<span><span class="va">d_conc</span><span class="op">$</span><span class="va">timeu_col</span> <span class="op">&lt;-</span> <span class="st">"hr"</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">[</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dose"</span>, <span class="st">"Time"</span>, <span class="st">"Subject"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">d_dose</span><span class="op">$</span><span class="va">doseu_col</span> <span class="op">&lt;-</span> <span class="st">"mg/kg"</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">d_conc</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span>, concu <span class="op">=</span> <span class="st">"concu_col"</span>, timeu <span class="op">=</span> <span class="st">"timeu_col"</span><span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">d_dose</span>, <span class="va">Dose</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span>, doseu <span class="op">=</span> <span class="st">"doseu_col"</span><span class="op">)</span></span></code></pre></div>
<p>Then, create the data object the same way as typical. Results will
have units.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Interval Start Interval End  N AUClast (hr*mg/L) Cmax (mg/L)</span></span>
<span><span class="co">#&gt;               0           24 12       74.6 [24.3]           .</span></span>
<span><span class="co">#&gt;               0          Inf 12                 . 8.65 [17.0]</span></span>
<span><span class="co">#&gt;           Tmax (hr) Half-life (hr) AUCinf,obs (hr*mg/L)</span></span>
<span><span class="co">#&gt;                   .              .                    .</span></span>
<span><span class="co">#&gt;  1.14 [0.630, 3.55]    8.18 [2.12]           115 [28.4]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Caption: AUClast, Cmax, AUCinf,obs: geometric mean and geometric coefficient of variation; Tmax: median and range; Half-life: arithmetic mean and standard deviation; N: number of subjects</span></span></code></pre></div>
<p>It is also possible to specify the units without them coming from
columns in the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">[</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dose"</span>, <span class="st">"Time"</span>, <span class="st">"Subject"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">d_conc</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span>, concu <span class="op">=</span> <span class="st">"mg/L"</span>, timeu <span class="op">=</span> <span class="st">"hr"</span><span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">d_dose</span>, <span class="va">Dose</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span>, doseu <span class="op">=</span> <span class="st">"mg/kg"</span><span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Interval Start Interval End  N AUClast (hr*mg/L) Cmax (mg/L)</span></span>
<span><span class="co">#&gt;               0           24 12       74.6 [24.3]           .</span></span>
<span><span class="co">#&gt;               0          Inf 12                 . 8.65 [17.0]</span></span>
<span><span class="co">#&gt;           Tmax (hr) Half-life (hr) AUCinf,obs (hr*mg/L)</span></span>
<span><span class="co">#&gt;                   .              .                    .</span></span>
<span><span class="co">#&gt;  1.14 [0.630, 3.55]    8.18 [2.12]           115 [28.4]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Caption: AUClast, Cmax, AUCinf,obs: geometric mean and geometric coefficient of variation; Tmax: median and range; Half-life: arithmetic mean and standard deviation; N: number of subjects</span></span></code></pre></div>
<p>And, you can perform automatic unit conversions as long as the unit
conversions are defined without more information (e.g. convert between
mass or time units). For more complex conversions, see the information
below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">[</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dose"</span>, <span class="st">"Time"</span>, <span class="st">"Subject"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">d_conc</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span>, concu <span class="op">=</span> <span class="st">"mg/L"</span>, timeu <span class="op">=</span> <span class="st">"hr"</span>, concu_pref <span class="op">=</span> <span class="st">"ug/L"</span>, timeu_pref <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">d_dose</span>, <span class="va">Dose</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span>, doseu <span class="op">=</span> <span class="st">"mg/kg"</span><span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Interval Start Interval End  N AUClast (day*ug/L) Cmax (ug/L)</span></span>
<span><span class="co">#&gt;               0           24 12        3110 [24.3]           .</span></span>
<span><span class="co">#&gt;               0          Inf 12                  . 8650 [17.0]</span></span>
<span><span class="co">#&gt;              Tmax (day) Half-life (day) AUCinf,obs (day*ug/L)</span></span>
<span><span class="co">#&gt;                       .               .                     .</span></span>
<span><span class="co">#&gt;  0.0473 [0.0262, 0.148]  0.341 [0.0881]           4780 [28.4]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Caption: AUClast, Cmax, AUCinf,obs: geometric mean and geometric coefficient of variation; Tmax: median and range; Half-life: arithmetic mean and standard deviation; N: number of subjects</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="steps-to-manually-add-units-to-an-nca-analysis">Steps to manually add units to an NCA analysis<a class="anchor" aria-label="anchor" href="#steps-to-manually-add-units-to-an-nca-analysis"></a>
</h3>
<p>For more details on parts of this NCA calculation example unrelated
to units, see the <a href="v02-example-theophylline.html">theophylline
example vignette</a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span> <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">[</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dose"</span>, <span class="st">"Time"</span>, <span class="st">"Subject"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">d_dose</span>, <span class="va">Dose</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span></span></code></pre></div>
<p>The difference from a calculation without units comes when setting up
the <code>PKNCAdata</code> object. You will add the units with the
<code>units</code> argument.</p>
<p>Since no urine or other similar collection is performed, the
<code>amountu</code> argument is omitted for
<code><a href="../reference/pknca_units_table.html">pknca_units_table()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_units</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pknca_units_table.html">pknca_units_table</a></span><span class="op">(</span></span>
<span>    concu<span class="op">=</span><span class="st">"mg/L"</span>, doseu<span class="op">=</span><span class="st">"mg/kg"</span>, timeu<span class="op">=</span><span class="st">"hr"</span>,</span>
<span>    <span class="co"># use molar units for concentrations and AUCs</span></span>
<span>    conversions<span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        PPORRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(mg/kg)/(hr*mg/L)"</span>, <span class="st">"(mg/kg)/(mg/L)"</span>, <span class="st">"mg/L"</span>, <span class="st">"hr*mg/L"</span><span class="op">)</span>,</span>
<span>        PPSTRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L/hr/kg"</span>, <span class="st">"L/kg"</span>, <span class="st">"mmol/L"</span>, <span class="st">"hr*mmol/L"</span><span class="op">)</span>,</span>
<span>        conversion_factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">180.164</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">180.164</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span>, units<span class="op">=</span><span class="va">d_units</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Interval Start Interval End  N AUClast (hr*mmol/L) Cmax (mmol/L)</span></span>
<span><span class="co">#&gt;               0           24 12        0.414 [24.3]             .</span></span>
<span><span class="co">#&gt;               0          Inf 12                   . 0.0480 [17.0]</span></span>
<span><span class="co">#&gt;           Tmax (hr) Half-life (hr) AUCinf,obs (hr*mmol/L)</span></span>
<span><span class="co">#&gt;                   .              .                      .</span></span>
<span><span class="co">#&gt;  1.14 [0.630, 3.55]    8.18 [2.12]           0.637 [28.4]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Caption: AUClast, Cmax, AUCinf,obs: geometric mean and geometric coefficient of variation; Tmax: median and range; Half-life: arithmetic mean and standard deviation; N: number of subjects</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="prepare-a-unit-assignment-and-conversion-table">Prepare a Unit Assignment and Conversion Table<a class="anchor" aria-label="anchor" href="#prepare-a-unit-assignment-and-conversion-table"></a>
</h2>
<p>A unit assignment and conversion table can be generated as a
data.frame to use with the <code><a href="../reference/pknca_units_table.html">pknca_units_table()</a></code> function or
manually.</p>
<p>The simplest method each of the types of units for inputs and
automatically generates the units for each NCA parameter.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_units_auto</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pknca_units_table.html">pknca_units_table</a></span><span class="op">(</span>concu<span class="op">=</span><span class="st">"ng/mL"</span>, doseu<span class="op">=</span><span class="st">"mg"</span>, amountu<span class="op">=</span><span class="st">"mg"</span>, timeu<span class="op">=</span><span class="st">"hr"</span><span class="op">)</span></span>
<span><span class="co"># Show a selection of the units generated</span></span>
<span><span class="va">d_units_auto</span><span class="op">[</span><span class="va">d_units_auto</span><span class="op">$</span><span class="va">PPTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cmax"</span>, <span class="st">"tmax"</span>, <span class="st">"auclast"</span>, <span class="st">"cl.obs"</span>, <span class="st">"vd.obs"</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;          PPORRESU PPTESTCD</span></span>
<span><span class="co">#&gt; 22             hr     tmax</span></span>
<span><span class="co">#&gt; 51          ng/mL     cmax</span></span>
<span><span class="co">#&gt; 81       hr*ng/mL  auclast</span></span>
<span><span class="co">#&gt; 117 mg/(hr*ng/mL)   cl.obs</span></span></code></pre></div>
<p>As you see above, the default units table has a column for the
<code>PPTESTCD</code> indicating the parameter. And, the column
<code>PPORRESU</code> indicates what the default units are.</p>
<p>Without unit conversion, the units for some parameters (notably
clearances and volumes) are not so useful. You can add a conversion
table to make any units into the desired units. For automatic conversion
to work, the units must always be convertible (by the <code>units</code>
library). Notably for automatic conversion, you cannot go from mass to
molar units since there is not a unique conversion from mass to
moles.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_units_clean</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pknca_units_table.html">pknca_units_table</a></span><span class="op">(</span></span>
<span>    concu<span class="op">=</span><span class="st">"ng/mL"</span>, doseu<span class="op">=</span><span class="st">"mg"</span>, amountu<span class="op">=</span><span class="st">"mg"</span>, timeu<span class="op">=</span><span class="st">"hr"</span>,</span>
<span>    conversions<span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        PPORRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mg/(hr*ng/mL)"</span>, <span class="st">"mg/(ng/mL)"</span>, <span class="st">"hr"</span><span class="op">)</span>,</span>
<span>        PPSTRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L/hr"</span>, <span class="st">"L"</span>, <span class="st">"day"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># Show a selection of the units generated</span></span>
<span><span class="va">d_units_clean</span><span class="op">[</span><span class="va">d_units_clean</span><span class="op">$</span><span class="va">PPTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cmax"</span>, <span class="st">"tmax"</span>, <span class="st">"auclast"</span>, <span class="st">"cl.obs"</span>, <span class="st">"vd.obs"</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;          PPORRESU PPTESTCD PPSTRESU conversion_factor</span></span>
<span><span class="co">#&gt; 22             hr     tmax      day      4.166667e-02</span></span>
<span><span class="co">#&gt; 51          ng/mL     cmax    ng/mL      1.000000e+00</span></span>
<span><span class="co">#&gt; 81       hr*ng/mL  auclast hr*ng/mL      1.000000e+00</span></span>
<span><span class="co">#&gt; 117 mg/(hr*ng/mL)   cl.obs     L/hr      1.000000e+03</span></span></code></pre></div>
<p>Now, the units are much cleaner to look at.</p>
<p>To do a conversion that is not possible directly with the
<code>units</code> library, you can add the conversion factor manually
by adding the <code>conversion_factor</code> column. You can
mix-and-match manual and automatic modification by setting the
<code>conversion_factor</code> column to <code>NA</code> when you want
automatic conversion. In the example below, we convert concentration
units to molar. Note that AUC units are not set to molar because we did
not specify that conversion; all conversions must be specified.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_units_clean_manual</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pknca_units_table.html">pknca_units_table</a></span><span class="op">(</span></span>
<span>    concu<span class="op">=</span><span class="st">"ng/mL"</span>, doseu<span class="op">=</span><span class="st">"mg"</span>, amountu<span class="op">=</span><span class="st">"mg"</span>, timeu<span class="op">=</span><span class="st">"hr"</span>,</span>
<span>    conversions<span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        PPORRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mg/(hr*ng/mL)"</span>, <span class="st">"mg/(ng/mL)"</span>, <span class="st">"hr"</span>, <span class="st">"ng/mL"</span><span class="op">)</span>,</span>
<span>        PPSTRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L/hr"</span>, <span class="st">"L"</span>, <span class="st">"day"</span>, <span class="st">"nmol/L"</span><span class="op">)</span>,</span>
<span>        conversion_factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1000</span><span class="op">/</span><span class="fl">123</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># Show a selection of the units generated</span></span>
<span><span class="va">d_units_clean_manual</span><span class="op">[</span><span class="va">d_units_clean_manual</span><span class="op">$</span><span class="va">PPTESTCD</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cmax"</span>, <span class="st">"tmax"</span>, <span class="st">"auclast"</span>, <span class="st">"cl.obs"</span>, <span class="st">"vd.obs"</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;          PPORRESU PPTESTCD PPSTRESU conversion_factor</span></span>
<span><span class="co">#&gt; 22             hr     tmax      day      4.166667e-02</span></span>
<span><span class="co">#&gt; 51          ng/mL     cmax   nmol/L      8.130081e+00</span></span>
<span><span class="co">#&gt; 81       hr*ng/mL  auclast hr*ng/mL      1.000000e+00</span></span>
<span><span class="co">#&gt; 117 mg/(hr*ng/mL)   cl.obs     L/hr      1.000000e+03</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="how-do-i-add-different-unit-conversions-for-different-analytes">How do I add different unit conversions for different analytes?<a class="anchor" aria-label="anchor" href="#how-do-i-add-different-unit-conversions-for-different-analytes"></a>
</h2>
<p>Sometimes, when multiple analytes are used and, for example, molar
outputs are desired while inputs are in mass units. Different unit
conversions may be required for different inputs.</p>
<p>Different unit conversions can be used by adding the grouping column
to the units specification.</p>
<p>Start by setting up a concentration dataset with two analytes. Since
the dosing doesn’t have an “Analyte” column, it will be matched to all
concentration measures for the subject.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_conc_theoph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">d_conc_theoph</span><span class="op">$</span><span class="va">Analyte</span> <span class="op">&lt;-</span> <span class="st">"Theophylline"</span></span>
<span><span class="co"># Approximately 6% of theophylline is metabolized to caffeine</span></span>
<span><span class="co"># (https://www.pharmgkb.org/pathway/PA165958541).  Let's pretend that means it</span></span>
<span><span class="co"># has 6% of the theophylline concentration at all times.</span></span>
<span><span class="va">d_conc_caffeine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">)</span></span>
<span><span class="va">d_conc_caffeine</span><span class="op">$</span><span class="va">conc</span> <span class="op">&lt;-</span> <span class="fl">0.06</span><span class="op">*</span><span class="va">d_conc_caffeine</span><span class="op">$</span><span class="va">conc</span></span>
<span><span class="va">d_conc_caffeine</span><span class="op">$</span><span class="va">Analyte</span> <span class="op">&lt;-</span> <span class="st">"Caffeine"</span></span>
<span><span class="va">d_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">d_conc_theoph</span>, <span class="va">d_conc_caffeine</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">[</span><span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/Theoph.html" class="external-link">Theoph</a></span><span class="op">$</span><span class="va">Time</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>                                  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dose"</span>, <span class="st">"Time"</span>, <span class="st">"Subject"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Setup the units with an “Analyte” column to separate the units
used.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_units_theoph</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pknca_units_table.html">pknca_units_table</a></span><span class="op">(</span></span>
<span>    concu<span class="op">=</span><span class="st">"mg/L"</span>, doseu<span class="op">=</span><span class="st">"mg/kg"</span>, timeu<span class="op">=</span><span class="st">"hr"</span>,</span>
<span>    <span class="co"># use molar units for concentrations and AUCs</span></span>
<span>    conversions<span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        PPORRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(mg/kg)/(hr*mg/L)"</span>, <span class="st">"(mg/kg)/(mg/L)"</span>, <span class="st">"mg/L"</span>, <span class="st">"hr*mg/L"</span><span class="op">)</span>,</span>
<span>        PPSTRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L/hr/kg"</span>, <span class="st">"L/kg"</span>, <span class="st">"mmol/L"</span>, <span class="st">"hr*mmol/L"</span><span class="op">)</span>,</span>
<span>        conversion_factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">180.164</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">180.164</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">d_units_theoph</span><span class="op">$</span><span class="va">Analyte</span> <span class="op">&lt;-</span> <span class="st">"Theophylline"</span></span>
<span><span class="va">d_units_caffeine</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/pknca_units_table.html">pknca_units_table</a></span><span class="op">(</span></span>
<span>    concu<span class="op">=</span><span class="st">"mg/L"</span>, doseu<span class="op">=</span><span class="st">"mg/kg"</span>, timeu<span class="op">=</span><span class="st">"hr"</span>,</span>
<span>    <span class="co"># use molar units for concentrations and AUCs</span></span>
<span>    conversions<span class="op">=</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>        PPORRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(mg/kg)/(hr*mg/L)"</span>, <span class="st">"(mg/kg)/(mg/L)"</span>, <span class="st">"mg/L"</span>, <span class="st">"hr*mg/L"</span><span class="op">)</span>,</span>
<span>        PPSTRESU<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L/hr/kg"</span>, <span class="st">"L/kg"</span>, <span class="st">"mmol/L"</span>, <span class="st">"hr*mmol/L"</span><span class="op">)</span>,</span>
<span>        conversion_factor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">194.19</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">194.19</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">d_units_caffeine</span><span class="op">$</span><span class="va">Analyte</span> <span class="op">&lt;-</span> <span class="st">"Caffeine"</span></span>
<span><span class="va">d_units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">d_units_theoph</span>, <span class="va">d_units_caffeine</span><span class="op">)</span></span></code></pre></div>
<p>Now, calculate adding the different units per analyte to the data
object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">o_conc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAconc.html">PKNCAconc</a></span><span class="op">(</span><span class="va">d_conc</span>, <span class="va">conc</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span><span class="op">/</span><span class="va">Analyte</span><span class="op">)</span></span>
<span><span class="va">o_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdose.html">PKNCAdose</a></span><span class="op">(</span><span class="va">d_dose</span>, <span class="va">Dose</span><span class="op">~</span><span class="va">Time</span><span class="op">|</span><span class="va">Subject</span><span class="op">)</span></span>
<span><span class="va">o_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PKNCAdata.html">PKNCAdata</a></span><span class="op">(</span><span class="va">o_conc</span>, <span class="va">o_dose</span>, units<span class="op">=</span><span class="va">d_units</span><span class="op">)</span></span>
<span><span class="va">o_nca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pk.nca.html">pk.nca</a></span><span class="op">(</span><span class="va">o_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">o_nca</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Interval Start Interval End      Analyte  N AUClast (hr*mmol/L)  Cmax (mmol/L)</span></span>
<span><span class="co">#&gt;               0           24 Theophylline 12        0.414 [24.3]              .</span></span>
<span><span class="co">#&gt;               0          Inf Theophylline 12                   .  0.0480 [17.0]</span></span>
<span><span class="co">#&gt;               0           24     Caffeine 12       0.0231 [24.3]              .</span></span>
<span><span class="co">#&gt;               0          Inf     Caffeine 12                   . 0.00267 [17.0]</span></span>
<span><span class="co">#&gt;           Tmax (hr) Half-life (hr) AUCinf,obs (hr*mmol/L)</span></span>
<span><span class="co">#&gt;                   .              .                      .</span></span>
<span><span class="co">#&gt;  1.14 [0.630, 3.55]    8.18 [2.12]           0.637 [28.4]</span></span>
<span><span class="co">#&gt;                   .              .                      .</span></span>
<span><span class="co">#&gt;  1.14 [0.630, 3.55]    8.18 [2.12]          0.0355 [28.4]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Caption: AUClast, Cmax, AUCinf,obs: geometric mean and geometric coefficient of variation; Tmax: median and range; Half-life: arithmetic mean and standard deviation; N: number of subjects</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
