<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Interpolate concentrations between measurements or extrapolate concentrations after the last measurement. — interp.extrap.conc • PKNCA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interpolate concentrations between measurements or extrapolate concentrations after the last measurement. — interp.extrap.conc"><meta name="description" content="interpolate.conc() and extrapolate.conc() returns an interpolated (or
extrapolated) concentration. interp.extrap.conc() will choose whether
interpolation or extrapolation is required and will also operate on many
concentrations.  These will typically be used to estimate the concentration
between two measured concentrations or after the last measured concentration.
Of note, these functions will not extrapolate prior to the first point."><meta property="og:description" content="interpolate.conc() and extrapolate.conc() returns an interpolated (or
extrapolated) concentration. interp.extrap.conc() will choose whether
interpolation or extrapolation is required and will also operate on many
concentrations.  These will typically be used to estimate the concentration
between two measured concentrations or after the last measured concentration.
Of note, these functions will not extrapolate prior to the first point."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PKNCA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/v01-introduction-and-usage.html">Introduction to PKNCA and Usage Instructions</a></li>
    <li><a class="dropdown-item" href="../articles/v02-example-theophylline.html">Computing NCA Parameters for Theophylline</a></li>
    <li><a class="dropdown-item" href="../articles/v03-selection-of-calculation-intervals.html">Selection of Calculation Intervals</a></li>
    <li><a class="dropdown-item" href="../articles/v04-sparse.html">Sparse NCA Calculations</a></li>
    <li><a class="dropdown-item" href="../articles/v05-auc-calculation-with-PKNCA.html">AUC Calculation with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation-tobit.html">Half-life calculation with Tobit regression</a></li>
    <li><a class="dropdown-item" href="../articles/v06-half-life-calculation.html">Half-Life Calculation</a></li>
    <li><a class="dropdown-item" href="../articles/v07-post-processing.html">Post-Processing</a></li>
    <li><a class="dropdown-item" href="../articles/v07-unit-conversion.html">Unit Assignment and Conversion with PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v08-data-imputation.html">Data Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/v20-superposition.html">Superposition of Pharmacokinetic Data</a></li>
    <li><a class="dropdown-item" href="../articles/v21-methods-for-dose-aware-interpolation-and-extrapolation.html">Methods Used for Dose-Aware Concentration Interpolation/Extrapolation</a></li>
    <li><a class="dropdown-item" href="../articles/v22-time-to-steady-state.html">Noncompartmental evaluation of time to steady-state</a></li>
    <li><a class="dropdown-item" href="../articles/v23-auc-integration-methods.html">AUC integration methods</a></li>
    <li><a class="dropdown-item" href="../articles/v30-training-session.html">PKNCA Training Sessions</a></li>
    <li><a class="dropdown-item" href="../articles/v40-options-for-controlling-PKNCA.html">Options for Controlling PKNCA</a></li>
    <li><a class="dropdown-item" href="../articles/v60-PKNCA-validation.html">PKNCA Validation</a></li>
    <li><a class="dropdown-item" href="../articles/v80-writing-parameter-functions.html">Writing PKNCA Parameter Functions</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/billdenney/pknca/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Interpolate concentrations between measurements or extrapolate concentrations after the last measurement.</h1>
      <small class="dont-index">Source: <a href="https://github.com/billdenney/pknca/blob/main/R/interpolate.conc.R" class="external-link"><code>R/interpolate.conc.R</code></a></small>
      <div class="d-none name"><code>interp.extrap.conc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>interpolate.conc()</code> and <code>extrapolate.conc()</code> returns an interpolated (or
extrapolated) concentration. <code>interp.extrap.conc()</code> will choose whether
interpolation or extrapolation is required and will also operate on many
concentrations.  These will typically be used to estimate the concentration
between two measured concentrations or after the last measured concentration.
Of note, these functions will not extrapolate prior to the first point.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">interp.extrap.conc</span><span class="op">(</span></span>
<span>  <span class="va">conc</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">time.out</span>,</span>
<span>  lambda.z <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  clast <span class="op">=</span> <span class="fu"><a href="pk.calc.clast.obs.html">pk.calc.clast.obs</a></span><span class="op">(</span><span class="va">conc</span>, <span class="va">time</span><span class="op">)</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  auc.type <span class="op">=</span> <span class="st">"AUCinf"</span>,</span>
<span>  <span class="va">interp.method</span>,</span>
<span>  <span class="va">extrap.method</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  conc.blq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conc.na <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">interpolate.conc</span><span class="op">(</span></span>
<span>  <span class="va">conc</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">time.out</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">interp.method</span>,</span>
<span>  conc.blq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conc.na <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conc.origin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">extrapolate.conc</span><span class="op">(</span></span>
<span>  <span class="va">conc</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">time.out</span>,</span>
<span>  lambda.z <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  clast <span class="op">=</span> <span class="fu"><a href="pk.calc.clast.obs.html">pk.calc.clast.obs</a></span><span class="op">(</span><span class="va">conc</span>, <span class="va">time</span><span class="op">)</span>,</span>
<span>  auc.type <span class="op">=</span> <span class="st">"AUCinf"</span>,</span>
<span>  <span class="va">extrap.method</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  conc.na <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conc.blq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">interp.extrap.conc.dose</span><span class="op">(</span></span>
<span>  <span class="va">conc</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  <span class="va">time.dose</span>,</span>
<span>  route.dose <span class="op">=</span> <span class="st">"extravascular"</span>,</span>
<span>  duration.dose <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">time.out</span>,</span>
<span>  out.after <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  conc.blq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conc.na <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-conc">conc<a class="anchor" aria-label="anchor" href="#arg-conc"></a></dt>
<dd><p>Measured concentrations</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Time of the measurement of the concentrations</p></dd>


<dt id="arg-time-out">time.out<a class="anchor" aria-label="anchor" href="#arg-time-out"></a></dt>
<dd><p>Time when interpolation is requested (vector for
<code>interp.extrap.conc()</code>, scalar otherwise)</p></dd>


<dt id="arg-lambda-z">lambda.z<a class="anchor" aria-label="anchor" href="#arg-lambda-z"></a></dt>
<dd><p>The elimination rate (in units of inverse time) for
extrapolation</p></dd>


<dt id="arg-clast">clast<a class="anchor" aria-label="anchor" href="#arg-clast"></a></dt>
<dd><p>The last observed concentration above the limit of
quantification.  If not given, <code>clast</code> is calculated from
<code><a href="pk.calc.clast.obs.html">pk.calc.clast.obs()</a></code></p></dd>


<dt id="arg-options">options<a class="anchor" aria-label="anchor" href="#arg-options"></a></dt>
<dd><p>List of changes to the default PKNCA options (see
<code><a href="PKNCA.options.html">PKNCA.options()</a></code>)</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The method for integration (one of 'lin up/log down',
'lin-log', or 'linear')</p></dd>


<dt id="arg-auc-type">auc.type<a class="anchor" aria-label="anchor" href="#arg-auc-type"></a></dt>
<dd><p>The type of AUC to compute.  Choices are 'AUCinf', 'AUClast',
and 'AUCall'.</p></dd>


<dt id="arg-interp-method-extrap-method">interp.method, extrap.method<a class="anchor" aria-label="anchor" href="#arg-interp-method-extrap-method"></a></dt>
<dd><p>deprecated in favor of method and auc.type</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code>interpolate.conc()</code> or
<code>extrapolate.conc()</code>.</p></dd>


<dt id="arg-conc-blq">conc.blq<a class="anchor" aria-label="anchor" href="#arg-conc-blq"></a></dt>
<dd><p>How to handle BLQ values. (See <code><a href="clean.conc.blq.html">clean.conc.blq()</a></code> for usage
instructions.)</p></dd>


<dt id="arg-conc-na">conc.na<a class="anchor" aria-label="anchor" href="#arg-conc-na"></a></dt>
<dd><p>How to handle NA concentrations.  (See <code><a href="clean.conc.na.html">clean.conc.na()</a></code>)</p></dd>


<dt id="arg-check">check<a class="anchor" aria-label="anchor" href="#arg-check"></a></dt>
<dd><p>Run <code><a href="assert_conc_time.html">assert_conc_time()</a></code>, <code><a href="clean.conc.blq.html">clean.conc.blq()</a></code>, and
<code><a href="clean.conc.na.html">clean.conc.na()</a></code>?</p></dd>


<dt id="arg-conc-origin">conc.origin<a class="anchor" aria-label="anchor" href="#arg-conc-origin"></a></dt>
<dd><p>The concentration before the first measurement.
<code>conc.origin</code> is typically used to set predose values to zero (default),
set a predose concentration for endogenous compounds, or set predose
concentrations to <code>NA</code> if otherwise unknown.</p></dd>


<dt id="arg-time-dose">time.dose<a class="anchor" aria-label="anchor" href="#arg-time-dose"></a></dt>
<dd><p>Time of the dose</p></dd>


<dt id="arg-route-dose">route.dose<a class="anchor" aria-label="anchor" href="#arg-route-dose"></a></dt>
<dd><p>What is the route of administration ("intravascular" or
"extravascular").  See the details for how this parameter is used.</p></dd>


<dt id="arg-duration-dose">duration.dose<a class="anchor" aria-label="anchor" href="#arg-duration-dose"></a></dt>
<dd><p>What is the duration of administration? See the details
for how this parameter is used.</p></dd>


<dt id="arg-out-after">out.after<a class="anchor" aria-label="anchor" href="#arg-out-after"></a></dt>
<dd><p>Should interpolation occur from the data before (<code>FALSE</code>) or
after (<code>TRUE</code>) the interpolated point?  See the details for how this
parameter is used.  It only has a meaningful effect at the instant of an IV
bolus dose.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The interpolated or extrapolated concentration value as a scalar
double (or vector for <code>interp.extrap.conc()</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An <code>NA</code> value for the <code>lambda.z</code> parameter will prevent extrapolation.</p>
<dl><dt>extrap.method</dt>
<dd>
<dl><dt>'AUCinf'</dt>
<dd><p>Use lambda.z to extrapolate beyond the last point with the half-life.</p></dd>

<dt>'AUCall'</dt>
<dd><p>If the last point is above the limit of quantification or missing, this is identical to 'AUCinf'. If the last point is below the limit of quantification, then linear interpolation between the Clast and the next BLQ is used for that  interval and all additional points are extrapolated as 0.</p></dd>

<dt>'AUClast'</dt>
<dd><p>Extrapolates all points after the last above the  limit of quantification as 0.</p></dd>


</dl></dd>


</dl><p><code>duration.dose</code> and <code>direction.out</code> are ignored if <code>route.dose == "extravascular"</code>.  <code>direction.out</code> is ignored if <code>duration.dose &gt; 0</code>.</p>
<p><code>route.dose</code> and <code>duration.dose</code> affect how interpolation/extrapolation of
the concentration occurs at the time of dosing.  If <code>route.dose == "intravascular"</code> and <code>duration.dose == 0</code> then extrapolation occurs for an IV
bolus using <code><a href="pk.calc.c0.html">pk.calc.c0()</a></code> with the data after dosing.  Otherwise (either
<code>route.dose == "extravascular"</code> or <code>duration.dose &gt; 0</code>), extrapolation occurs
using the concentrations before dosing and estimating the half-life (or more
precisely, estimating <code>lambda.z</code>).  Finally, <code>direction.out</code> can change the
direction of interpolation in cases with <code>route.dose == "intravascular"</code> and
<code>duration.dose == 0</code>.  When <code>direction.out == "before"</code> interpolation occurs
only with data before the dose (as is the case for <code>route.dose == "extravascular"</code>), but if <code>direction.out == "after"</code> interpolation occurs
from the data after dosing.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>

<ul><li><p><code>interpolate.conc()</code>: Interpolate concentrations through Tlast (inclusive)</p></li>
<li><p><code>extrapolate.conc()</code>: Extrapolate concentrations after Tlast</p></li>
<li><p><code>interp.extrap.conc.dose()</code>: Interpolate and extrapolate concentrations
without interpolating or extrapolating beyond doses.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="pk.calc.clast.obs.html">pk.calc.clast.obs()</a></code>, <code><a href="pk.calc.half.life.html">pk.calc.half.life()</a></code>, <code><a href="pk.calc.c0.html">pk.calc.c0()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bill Denney, Clare Buckeridge.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

